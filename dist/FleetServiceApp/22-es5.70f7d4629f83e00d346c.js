!function(){function n(n,t,e,i,c,a,r){try{var o=n[a](r),s=o.value}catch(l){return void e(l)}o.done?t(s):Promise.resolve(s).then(i,c)}function t(t){return function(){var e=this,i=arguments;return new Promise((function(c,a){var r=t.apply(e,i);function o(t){n(r,c,a,o,s,"next",t)}function s(t){n(r,c,a,o,s,"throw",t)}o(void 0)}))}}function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function i(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function c(n,t,e){return t&&i(n.prototype,t),e&&i(n,e),n}(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{R7St:function(n,t,i){"use strict";i.d(t,"a",(function(){return a}));var a=function(){function n(){e(this,n)}return c(n,[{key:"formatNumberToString",value:function(n){var t=Math.round(n).toString(),e="",i="",c=t.indexOf(".");c>0?(e=t.substr(0,c),i=t.substr(c,t.length)):e=t.substr(0,t.length);for(var a=e.split("").reverse(),r=Math.floor(a.length/3),o=0;o<r;o++){var s,l=a.lastIndexOf(",");s=l>0?l+4:3,a.splice(s,0,",")}var d=a.reverse().join("");return","==d.split("")[0]&&(d=d.substr(1,d.length)),""!=i&&(d+=i=i.replace(/\,/g,".")),d}}]),n}()},gLOO:function(n,i,a){"use strict";a.r(i),a.d(i,"DashboardClientModule",(function(){return L}));var r,o=a("ofXK"),s=a("3Pt+"),l=a("tyNb"),d=a("uswQ"),u=a("R7St"),p=a("KBdt"),b=a("K9Qb"),f=a("KyVN"),v=a("7I7t"),h=a("PSD3"),m=a.n(h),g=a("fXoL"),x=a("JP3n"),_=a("FMJ1"),T=a("a9jy"),y=a("aouF"),w=a("3+Ze"),O=a("Wp6s"),C=a("bv9b"),M=((r=function(){function n(){e(this,n),this.transactionSelected=null,this.onShowDetailTrx=new g.q,this.onApproveTrx=new g.q,this.onDeniedTrx=new g.q}return c(n,[{key:"ngOnInit",value:function(){}},{key:"showDetailTrx",value:function(){this.onShowDetailTrx.emit(this.transactionSelected)}},{key:"approveTrx",value:function(){this.onApproveTrx.emit(this.transactionSelected)}},{key:"deniedTrx",value:function(){this.onDeniedTrx.emit(this.transactionSelected)}},{key:"setTransactionSelected",set:function(n){this.transactionSelected=n}}]),n}()).\u0275fac=function(n){return new(n||r)},r.\u0275cmp=g.Pb({type:r,selectors:[["app-card-trx-detail"]],inputs:{setTransactionSelected:["transaction","setTransactionSelected"]},outputs:{onShowDetailTrx:"onShowDetailTrx",onApproveTrx:"onApproveTrx",onDeniedTrx:"onDeniedTrx"},decls:40,vars:15,consts:[[1,"card-trx"],[1,"container-header"],[1,"container-info-header"],[1,"container-button-info"],["title","M\xe1s informaci\xf3n",1,"fas","fa-info-circle","text-info",3,"click"],[1,"container-info-content"],[1,"container-left"],[1,"trx-value"],[1,"container-button-action"],["title","Aprobar",1,"fas","fa-check-circle","text-success",3,"click"],["title","Negar",1,"fas","fa-times-circle","text-danger",3,"click"],["mode","indeterminate"]],template:function(n,t){1&n&&(g.bc(0,"mat-card",0),g.bc(1,"mat-card-title"),g.bc(2,"div",1),g.bc(3,"div",2),g.Mc(4),g.ac(),g.bc(5,"div",3),g.bc(6,"i",4),g.ic("click",(function(){return t.showDetailTrx()})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(7,"mat-card-content"),g.bc(8,"div",5),g.bc(9,"div"),g.bc(10,"strong"),g.Mc(11),g.ac(),g.ac(),g.bc(12,"div",6),g.bc(13,"ul"),g.bc(14,"li"),g.bc(15,"strong"),g.Mc(16,"Mantenimiento:"),g.ac(),g.Wb(17,"br"),g.Mc(18),g.ac(),g.bc(19,"li"),g.bc(20,"strong"),g.Mc(21,"Concesionario:"),g.ac(),g.Wb(22,"br"),g.Mc(23),g.ac(),g.bc(24,"li"),g.bc(25,"strong"),g.Mc(26,"Fecha:"),g.ac(),g.Wb(27,"br"),g.Mc(28),g.nc(29,"date"),g.ac(),g.bc(30,"div",7),g.bc(31,"h1"),g.Mc(32),g.nc(33,"currency"),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(34,"mat-card-actions"),g.bc(35,"div",8),g.bc(36,"i",9),g.ic("click",(function(){return t.approveTrx()})),g.ac(),g.bc(37,"i",10),g.ic("click",(function(){return t.deniedTrx()})),g.ac(),g.ac(),g.ac(),g.bc(38,"mat-card-footer"),g.Wb(39,"mat-progress-bar",11),g.ac(),g.ac()),2&n&&(g.Jb(4),g.Oc(" ",t.transactionSelected.code," "),g.Jb(7),g.Nc(t.transactionSelected.headerDetails.vehicle.licensePlate),g.Jb(7),g.Oc(" ",t.transactionSelected.headerDetails.maintenanceRoutine.name," "),g.Jb(5),g.Pc(" ",t.transactionSelected.headerDetails.dealer.name," - ",t.transactionSelected.headerDetails.branch.name," "),g.Jb(5),g.Oc(" ",g.pc(29,7,t.transactionSelected.registrationDate,"yyyy/MM/dd")," "),g.Jb(4),g.Oc(" ",g.rc(33,10,t.transactionSelected.value,"USD","symbol","1.0-0")," "))},directives:[O.a,O.j,O.d,O.b,O.e,C.a],pipes:[o.f,o.d],styles:[".card-trx[_ngcontent-%COMP%]{max-width:95%;margin:auto}.container-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.container-info-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:0;padding-bottom:0}.container-left[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0}.container-left[_ngcontent-%COMP%]{margin-top:20px}.container-left[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}.container-right[_ngcontent-%COMP%]{margin:auto}.container-button-action[_ngcontent-%COMP%]{display:flex;flex-direction:row;direction:rtl;margin-top:-30px}.container-button-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;margin-right:5px}.container-button-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:active{transform:scale(.9)}.trx-value[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:10px}.container-button-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer}.container-button-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:active{transform:scale(.9)}"]}),r),P=a("9Wwi");function S(n,t){if(1&n){var e=g.cc();g.bc(0,"app-card-trx-detail",22),g.ic("onShowDetailTrx",(function(n){return g.Dc(e),g.mc(2).setTransactionToShow(n)}))("onApproveTrx",(function(n){return g.Dc(e),g.mc(2).setTransactionToApprove(n)}))("onDeniedTrx",(function(n){return g.Dc(e),g.mc(2).setTransactionToDenied(n)})),g.ac()}2&n&&g.uc("transaction",t.$implicit)}function A(n,t){if(1&n&&(g.bc(0,"div",20),g.Lc(1,S,1,1,"app-card-trx-detail",21),g.ac()),2&n){var e=g.mc();g.Jb(1),g.uc("ngForOf",e.lsTransactionsToApprove)}}function k(n,t){1&n&&(g.bc(0,"div"),g.bc(1,"div",23),g.bc(2,"h2"),g.Mc(3,"No tienes aprobaciones pendientes!"),g.ac(),g.ac(),g.ac())}function D(n,t){1&n&&(g.bc(0,"span"),g.Mc(1,"** Debe asociar una observaci\xf3n **"),g.ac())}function J(n,t){1&n&&(g.bc(0,"span"),g.Mc(1,"** Debe asociar una observaci\xf3n **"),g.ac())}function N(n,t){1&n&&g.Wb(0,"app-img-loading")}var R,I,j,E=[{path:"",component:d.a,children:[{path:"",component:(R=function(){function n(t,i,c,a){e(this,n),this.notificationService=t,this.dealerService=i,this.transactionService=c,this.movementService=a,this.lsTransactionsToApprove=[],this.lsMovements=[],this.APROBACION_ORDEN_DE_TRABAJO=5,this.CANCELACION_ORDEN_DE_TRABAJO=6,this.frmApprovedTrx=new s.j({txtObservationApprobation:new s.g("",[s.z.required,s.z.pattern(/^(\s+\S+\s*)*(?!\s).*$/)])}),this.frmCancelTrx=new s.j({txtObservationCancelation:new s.g("",[s.z.required,s.z.pattern(/^(\s+\S+\s*)*(?!\s).*$/)])}),this.trx_id=0,this.client={}}var i,a,r;return c(n,[{key:"ngOnInit",value:function(){this.initComponents()}},{key:"initComponents",value:function(){this.isAwaiting=!1,this.client.id=this.getClientId(),this.sharedFunctions=new u.a,this.getMovementList(),this.getTransactionsToApprove(this.client.id)}},{key:"getClientId",value:function(){return JSON.parse(sessionStorage.getItem("sessionUser")).company.id}},{key:"getTransactionsToApprove",value:function(n){var t=this;this.isAwaiting=!0,this.transactionService.getTransactionsToApprove(n).subscribe((function(n){t.lsTransactionsToApprove=n,t.isAwaiting=!1}))}},{key:"getMovementList",value:(r=t(regeneratorRuntime.mark((function n(){var t=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{this.movementService.getMovements().then((function(n){t.lsMovements=n}))}catch(e){console.warn(e)}case 1:case"end":return n.stop()}}),n,this)}))),function(){return r.apply(this,arguments)})},{key:"closePopUp",value:function(n){document.getElementById(n).style.display="none"}},{key:"openPopUp",value:function(n){document.getElementById(n).style.display="block"}},{key:"formatNumberToString",value:function(n){return this.sharedFunctions.formatNumberToString(n)}},{key:"setTransaction",value:function(n){this.transactionSelected=n,this.trx_id=n.id}},{key:"sendEmail",value:(a=t(regeneratorRuntime.mark((function n(t){var e,i,c,a,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=t.headerDetails.relatedTransaction.headerDetails.dealer.id,i=t.headerDetails.relatedTransaction.code,n.next=4,this.dealerService.getDealerById(e).toPromise();case 4:c=n.sent,a=c.contacts,(r={nameMessage:"Fleet Service",emailReceiver:a.filter((function(n){return 1==n.mustNotify})).map((function(n){return n.email})),typemessage:t.movement.id,nOrderwork:i}).emailReceiver.length>0&&this.notificationService.sendMail(r).subscribe((function(n){}));case 8:case"end":return n.stop()}}),n,this)}))),function(n){return a.apply(this,arguments)})},{key:"approveWorkOrder",value:function(){var n=this;this.isAwaiting=!0;var t=this.lsMovements.find((function(t){return t.id==n.APROBACION_ORDEN_DE_TRABAJO})),e=this.frmApprovedTrx.controls.txtObservationApprobation,i=this.setDataTransaction(this.transactionSelected,t,e.value);this.transactionService.processTransaction(i).subscribe((function(t){t.response&&(n.sendEmail(i),m.a.fire({position:"center",icon:"success",title:t.response,showConfirmButton:!0}),n.getTransactionsToApprove(n.client.id),n.closePopUp("container__Approbation"))})),this.isAwaiting=!1}},{key:"cancelWorkOrder",value:(i=t(regeneratorRuntime.mark((function n(){var t,e,i,c=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{this.isAwaiting=!0,t=this.lsMovements.find((function(n){return n.id==c.CANCELACION_ORDEN_DE_TRABAJO})),e=this.frmCancelTrx.controls.txtObservationCancelation,i=this.setDataTransaction(this.transactionSelected,t,e.value),this.transactionService.processTransaction(i).subscribe((function(n){n.response&&(c.sendEmail(i),m.a.fire({position:"center",icon:"success",title:n.response,showConfirmButton:!0}),c.getTransactionsToApprove(c.client.id),c.closePopUp("container__Cancelation"))})),this.isAwaiting=!1}catch(a){console.warn(a)}case 1:case"end":return n.stop()}}),n,this)}))),function(){return i.apply(this,arguments)})},{key:"setDataTransaction",value:function(n,t,e){var i=new p.a;i.movement=t,i.value=n.value,i.usu_id=v.a.validateUserLogged(),i.client=n.client,i.headerDetails=new b.a,i.headerDetails.relatedTransaction=n;var c=new f.a;c.usu_id=v.a.validateUserLogged(),c.description=e;var a=[];return null!=e&&a.push(c),i.lsObservations=a,i}},{key:"clearForms",value:function(){this.frmApprovedTrx.reset(),this.frmCancelTrx.reset()}},{key:"setTransactionToShow",value:function(n){this.setTransaction(n),this.openPopUp("container__resume")}},{key:"setTransactionToApprove",value:function(n){this.setTransaction(n),this.openPopUp("container__Approbation")}},{key:"setTransactionToDenied",value:function(n){this.setTransaction(n),this.openPopUp("container__Cancelation")}}]),n}(),R.\u0275fac=function(n){return new(n||R)(g.Vb(x.a),g.Vb(_.a),g.Vb(T.a),g.Vb(y.a))},R.\u0275cmp=g.Pb({type:R,selectors:[["app-dashboard-client"]],decls:63,vars:15,consts:[["id","container__content"],["class","container-cards",4,"ngIf"],[4,"ngIf"],["id","container__Approbation"],[1,"overlay"],[1,"card","card-review"],[1,"card-header","container__header"],[1,"container__buttonClose"],[1,"fas","fa-times",3,"click"],[1,"card-body"],[3,"trx_id"],[1,"card-footer"],[3,"formGroup"],["formControlName","txtObservationApprobation","cols","30","rows","2",1,"form-control"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],["id","container__Cancelation"],["formControlName","txtObservationCancelation","cols","30","rows","2",1,"form-control"],["id","container__resume"],[1,"container-cards"],[3,"transaction","onShowDetailTrx","onApproveTrx","onDeniedTrx",4,"ngFor","ngForOf"],[3,"transaction","onShowDetailTrx","onApproveTrx","onDeniedTrx"],[1,"container-nothing"]],template:function(n,t){1&n&&(g.bc(0,"div",0),g.bc(1,"h1"),g.Mc(2,"\xd3rdenes de trabajo por aprobar"),g.ac(),g.Lc(3,A,2,1,"div",1),g.Lc(4,k,4,0,"div",2),g.ac(),g.bc(5,"div",3),g.bc(6,"div",4),g.bc(7,"div",5),g.bc(8,"div",6),g.bc(9,"h2"),g.Mc(10),g.ac(),g.bc(11,"div",7),g.bc(12,"a"),g.bc(13,"i",8),g.ic("click",(function(){return t.closePopUp("container__Approbation")})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(14,"div",9),g.Wb(15,"app-transaction-review",10),g.ac(),g.bc(16,"div",11),g.bc(17,"form",12),g.bc(18,"div"),g.bc(19,"legend"),g.Mc(20,"Observaciones de la aprobaci\xf3n"),g.ac(),g.Lc(21,D,2,0,"span",2),g.bc(22,"textarea",13),g.Mc(23,"            "),g.ac(),g.ac(),g.ac(),g.bc(24,"div",14),g.bc(25,"button",15),g.ic("click",(function(){return t.closePopUp("container__Approbation"),t.clearForms()})),g.Mc(26," Cancelar "),g.ac(),g.bc(27,"button",16),g.ic("click",(function(){return t.approveWorkOrder()})),g.Mc(28," Guardar "),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(29,"div",17),g.bc(30,"div",4),g.bc(31,"div",5),g.bc(32,"div",6),g.bc(33,"h2"),g.Mc(34),g.ac(),g.bc(35,"div",7),g.bc(36,"a"),g.bc(37,"i",8),g.ic("click",(function(){return t.closePopUp("container__Cancelation")})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(38,"div",9),g.Wb(39,"app-transaction-review",10),g.ac(),g.bc(40,"div",11),g.bc(41,"form",12),g.bc(42,"legend"),g.Mc(43,"Observaciones de la cancelaci\xf3n"),g.ac(),g.Lc(44,J,2,0,"span",2),g.Wb(45,"textarea",18),g.bc(46,"div",14),g.bc(47,"button",15),g.ic("click",(function(){return t.closePopUp("container__Cancelation"),t.clearForms()})),g.Mc(48," Cancelar "),g.ac(),g.bc(49,"button",16),g.ic("click",(function(){return t.cancelWorkOrder()})),g.Mc(50," Guardar "),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(51,"div",19),g.bc(52,"div",4),g.bc(53,"div",5),g.bc(54,"div",6),g.bc(55,"h2"),g.Mc(56),g.ac(),g.bc(57,"div",7),g.bc(58,"a"),g.bc(59,"i",8),g.ic("click",(function(){return t.closePopUp("container__resume")})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(60,"div",9),g.Wb(61,"app-transaction-review",10),g.ac(),g.ac(),g.ac(),g.ac(),g.Lc(62,N,1,0,"app-img-loading",2)),2&n&&(g.Jb(3),g.uc("ngIf",t.lsTransactionsToApprove),g.Jb(1),g.uc("ngIf",0==t.lsTransactionsToApprove.length),g.Jb(6),g.Oc(" Aprobar orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),g.Jb(5),g.uc("trx_id",t.trx_id),g.Jb(2),g.uc("formGroup",t.frmApprovedTrx),g.Jb(4),g.uc("ngIf",t.frmApprovedTrx.invalid),g.Jb(6),g.uc("disabled",t.frmApprovedTrx.invalid),g.Jb(7),g.Oc(" Cancelar orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),g.Jb(5),g.uc("trx_id",t.trx_id),g.Jb(2),g.uc("formGroup",t.frmCancelTrx),g.Jb(3),g.uc("ngIf",t.frmCancelTrx.invalid),g.Jb(5),g.uc("disabled",t.frmCancelTrx.invalid),g.Jb(7),g.Oc(" Resumen orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),g.Jb(5),g.uc("trx_id",t.trx_id),g.Jb(1),g.uc("ngIf",t.isAwaiting))},directives:[o.o,w.a,s.B,s.r,s.k,s.c,s.q,s.i,o.n,M,P.a],styles:["#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px 50px;margin-left:250px}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%;overflow:scroll}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}#container__Approbation[_ngcontent-%COMP%], #container__Cancelation[_ngcontent-%COMP%], #container__resume[_ngcontent-%COMP%]{display:none}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}table[_ngcontent-%COMP%]{cursor:pointer;margin-top:80px}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;cursor:pointer;position:relative;left:93%;margin-bottom:20px;top:10px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}.container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.container__buttonClose[_ngcontent-%COMP%]{margin-top:10px}.card-review[_ngcontent-%COMP%]{width:1200px;height:auto}.container-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);row-gap:15px;column-gap:15px}@media only screen and (max-width:600px){#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:10px;margin-left:0}.container-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;row-gap:15px}}.container-nothing[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;left:0;bottom:0;right:0;color:#ccc;margin:auto;justify-content:center;align-items:center}"]}),R)}]}],U=((I=function n(){e(this,n)}).\u0275mod=g.Tb({type:I}),I.\u0275inj=g.Sb({factory:function(n){return new(n||I)},imports:[[l.f.forChild(E)],l.f]}),I),W=a("Z/wE"),L=((j=function n(){e(this,n)}).\u0275mod=g.Tb({type:j}),j.\u0275inj=g.Sb({factory:function(n){return new(n||j)},imports:[[o.c,s.l,s.w,W.a,U,O.h,C.b]]}),j)}}])}();