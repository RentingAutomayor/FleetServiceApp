(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{R7St:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));class c{formatNumberToString(t){const n=Math.round(t).toString();let e="",c="";const i=n.indexOf(".");i>0?(e=n.substr(0,i),c=n.substr(i,n.length)):e=n.substr(0,n.length);const a=e.split("").reverse(),o=Math.floor(a.length/3);for(let s=0;s<o;s++){let t=0;const n=a.lastIndexOf(",");t=n>0?n+4:3,a.splice(t,0,",")}let r=a.reverse().join("");return","==r.split("")[0]&&(r=r.substr(1,r.length)),""!=c&&(c=c.replace(/\,/g,"."),r+=c),r}}},gLOO:function(t,n,e){"use strict";e.r(n),e.d(n,"DashboardClientModule",(function(){return N}));var c=e("ofXK"),i=e("3Pt+"),a=e("tyNb"),o=e("uswQ"),r=e("R7St"),s=e("KBdt"),l=e("K9Qb"),d=e("KyVN"),p=e("7I7t"),b=e("PSD3"),u=e.n(b),g=e("fXoL"),h=e("JP3n"),m=e("FMJ1"),f=e("a9jy"),v=e("aouF"),x=e("3+Ze"),_=e("Wp6s"),T=e("bv9b");let O=(()=>{class t{constructor(){this.transactionSelected=null,this.onShowDetailTrx=new g.q,this.onApproveTrx=new g.q,this.onDeniedTrx=new g.q}set setTransactionSelected(t){this.transactionSelected=t}ngOnInit(){}showDetailTrx(){this.onShowDetailTrx.emit(this.transactionSelected)}approveTrx(){this.onApproveTrx.emit(this.transactionSelected)}deniedTrx(){this.onDeniedTrx.emit(this.transactionSelected)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=g.Pb({type:t,selectors:[["app-card-trx-detail"]],inputs:{setTransactionSelected:["transaction","setTransactionSelected"]},outputs:{onShowDetailTrx:"onShowDetailTrx",onApproveTrx:"onApproveTrx",onDeniedTrx:"onDeniedTrx"},decls:40,vars:15,consts:[[1,"card-trx"],[1,"container-header"],[1,"container-info-header"],[1,"container-button-info"],["title","M\xe1s informaci\xf3n",1,"fas","fa-info-circle","text-info",3,"click"],[1,"container-info-content"],[1,"container-left"],[1,"trx-value"],[1,"container-button-action"],["title","Aprobar",1,"fas","fa-check-circle","text-success",3,"click"],["title","Negar",1,"fas","fa-times-circle","text-danger",3,"click"],["mode","indeterminate"]],template:function(t,n){1&t&&(g.bc(0,"mat-card",0),g.bc(1,"mat-card-title"),g.bc(2,"div",1),g.bc(3,"div",2),g.Mc(4),g.ac(),g.bc(5,"div",3),g.bc(6,"i",4),g.ic("click",(function(){return n.showDetailTrx()})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(7,"mat-card-content"),g.bc(8,"div",5),g.bc(9,"div"),g.bc(10,"strong"),g.Mc(11),g.ac(),g.ac(),g.bc(12,"div",6),g.bc(13,"ul"),g.bc(14,"li"),g.bc(15,"strong"),g.Mc(16,"Mantenimiento:"),g.ac(),g.Wb(17,"br"),g.Mc(18),g.ac(),g.bc(19,"li"),g.bc(20,"strong"),g.Mc(21,"Concesionario:"),g.ac(),g.Wb(22,"br"),g.Mc(23),g.ac(),g.bc(24,"li"),g.bc(25,"strong"),g.Mc(26,"Fecha:"),g.ac(),g.Wb(27,"br"),g.Mc(28),g.nc(29,"date"),g.ac(),g.bc(30,"div",7),g.bc(31,"h1"),g.Mc(32),g.nc(33,"currency"),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(34,"mat-card-actions"),g.bc(35,"div",8),g.bc(36,"i",9),g.ic("click",(function(){return n.approveTrx()})),g.ac(),g.bc(37,"i",10),g.ic("click",(function(){return n.deniedTrx()})),g.ac(),g.ac(),g.ac(),g.bc(38,"mat-card-footer"),g.Wb(39,"mat-progress-bar",11),g.ac(),g.ac()),2&t&&(g.Jb(4),g.Oc(" ",n.transactionSelected.code," "),g.Jb(7),g.Nc(n.transactionSelected.headerDetails.vehicle.licensePlate),g.Jb(7),g.Oc(" ",n.transactionSelected.headerDetails.maintenanceRoutine.name," "),g.Jb(5),g.Pc(" ",n.transactionSelected.headerDetails.dealer.name," - ",n.transactionSelected.headerDetails.branch.name," "),g.Jb(5),g.Oc(" ",g.pc(29,7,n.transactionSelected.registrationDate,"yyyy/MM/dd")," "),g.Jb(4),g.Oc(" ",g.rc(33,10,n.transactionSelected.value,"USD","symbol","1.0-0")," "))},directives:[_.a,_.j,_.d,_.b,_.e,T.a],pipes:[c.f,c.d],styles:[".card-trx[_ngcontent-%COMP%]{max-width:95%;margin:auto}.container-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.container-info-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:0;padding-bottom:0}.container-left[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0}.container-left[_ngcontent-%COMP%]{margin-top:20px}.container-left[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}.container-right[_ngcontent-%COMP%]{margin:auto}.container-button-action[_ngcontent-%COMP%]{display:flex;flex-direction:row;direction:rtl;margin-top:-30px}.container-button-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;margin-right:5px}.container-button-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:active{transform:scale(.9)}.trx-value[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:10px}.container-button-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer}.container-button-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:active{transform:scale(.9)}"]}),t})();var C=e("9Wwi");function M(t,n){if(1&t){const t=g.cc();g.bc(0,"app-card-trx-detail",22),g.ic("onShowDetailTrx",(function(n){return g.Dc(t),g.mc(2).setTransactionToShow(n)}))("onApproveTrx",(function(n){return g.Dc(t),g.mc(2).setTransactionToApprove(n)}))("onDeniedTrx",(function(n){return g.Dc(t),g.mc(2).setTransactionToDenied(n)})),g.ac()}2&t&&g.uc("transaction",n.$implicit)}function w(t,n){if(1&t&&(g.bc(0,"div",20),g.Lc(1,M,1,1,"app-card-trx-detail",21),g.ac()),2&t){const t=g.mc();g.Jb(1),g.uc("ngForOf",t.lsTransactionsToApprove)}}function S(t,n){1&t&&(g.bc(0,"div"),g.bc(1,"div",23),g.bc(2,"h2"),g.Mc(3,"No tienes aprobaciones pendientes!"),g.ac(),g.ac(),g.ac())}function A(t,n){1&t&&(g.bc(0,"span"),g.Mc(1,"** Debe asociar una observaci\xf3n **"),g.ac())}function P(t,n){1&t&&(g.bc(0,"span"),g.Mc(1,"** Debe asociar una observaci\xf3n **"),g.ac())}function y(t,n){1&t&&g.Wb(0,"app-img-loading")}const D=[{path:"",component:o.a,children:[{path:"",component:(()=>{class t{constructor(t,n,e,c){this.notificationService=t,this.dealerService=n,this.transactionService=e,this.movementService=c,this.lsTransactionsToApprove=[],this.lsMovements=[],this.APROBACION_ORDEN_DE_TRABAJO=5,this.CANCELACION_ORDEN_DE_TRABAJO=6,this.frmApprovedTrx=new i.j({txtObservationApprobation:new i.g("",[i.z.required,i.z.pattern(/^(\s+\S+\s*)*(?!\s).*$/)])}),this.frmCancelTrx=new i.j({txtObservationCancelation:new i.g("",[i.z.required,i.z.pattern(/^(\s+\S+\s*)*(?!\s).*$/)])}),this.trx_id=0,this.client={}}ngOnInit(){this.initComponents()}initComponents(){this.isAwaiting=!1,this.client.id=this.getClientId(),this.sharedFunctions=new r.a,this.getMovementList(),this.getTransactionsToApprove(this.client.id)}getClientId(){return JSON.parse(sessionStorage.getItem("sessionUser")).company.id}getTransactionsToApprove(t){this.isAwaiting=!0,this.transactionService.getTransactionsToApprove(t).subscribe(t=>{this.lsTransactionsToApprove=t,this.isAwaiting=!1})}async getMovementList(){try{this.movementService.getMovements().then(t=>{this.lsMovements=t})}catch(t){console.warn(t)}}closePopUp(t){document.getElementById(t).style.display="none"}openPopUp(t){document.getElementById(t).style.display="block"}formatNumberToString(t){return this.sharedFunctions.formatNumberToString(t)}setTransaction(t){this.transactionSelected=t,this.trx_id=t.id}async sendEmail(t){const n=t.headerDetails.relatedTransaction.headerDetails.dealer.id,e=t.headerDetails.relatedTransaction.code,{contacts:c}=await this.dealerService.getDealerById(n).toPromise(),i={nameMessage:"Fleet Service",emailReceiver:c.filter(t=>1==t.mustNotify).map(t=>t.email),typemessage:t.movement.id,nOrderwork:e};i.emailReceiver.length>0&&this.notificationService.sendMail(i).subscribe(t=>{})}approveWorkOrder(){this.isAwaiting=!0;const t=this.lsMovements.find(t=>t.id==this.APROBACION_ORDEN_DE_TRABAJO),{txtObservationApprobation:n}=this.frmApprovedTrx.controls,e=this.setDataTransaction(this.transactionSelected,t,n.value);this.transactionService.processTransaction(e).subscribe(t=>{t.response&&(this.sendEmail(e),u.a.fire({position:"center",icon:"success",title:t.response,showConfirmButton:!0}),this.getTransactionsToApprove(this.client.id),this.closePopUp("container__Approbation"))}),this.isAwaiting=!1}async cancelWorkOrder(){try{this.isAwaiting=!0;const t=this.lsMovements.find(t=>t.id==this.CANCELACION_ORDEN_DE_TRABAJO),{txtObservationCancelation:n}=this.frmCancelTrx.controls,e=this.setDataTransaction(this.transactionSelected,t,n.value);this.transactionService.processTransaction(e).subscribe(t=>{t.response&&(this.sendEmail(e),u.a.fire({position:"center",icon:"success",title:t.response,showConfirmButton:!0}),this.getTransactionsToApprove(this.client.id),this.closePopUp("container__Cancelation"))}),this.isAwaiting=!1}catch(t){console.warn(t)}}setDataTransaction(t,n,e){const c=new s.a;c.movement=n,c.value=t.value,c.usu_id=p.a.validateUserLogged(),c.client=t.client,c.headerDetails=new l.a,c.headerDetails.relatedTransaction=t;const i=new d.a;i.usu_id=p.a.validateUserLogged(),i.description=e;const a=[];return null!=e&&a.push(i),c.lsObservations=a,c}clearForms(){this.frmApprovedTrx.reset(),this.frmCancelTrx.reset()}setTransactionToShow(t){this.setTransaction(t),this.openPopUp("container__resume")}setTransactionToApprove(t){this.setTransaction(t),this.openPopUp("container__Approbation")}setTransactionToDenied(t){this.setTransaction(t),this.openPopUp("container__Cancelation")}}return t.\u0275fac=function(n){return new(n||t)(g.Vb(h.a),g.Vb(m.a),g.Vb(f.a),g.Vb(v.a))},t.\u0275cmp=g.Pb({type:t,selectors:[["app-dashboard-client"]],decls:63,vars:15,consts:[["id","container__content"],["class","container-cards",4,"ngIf"],[4,"ngIf"],["id","container__Approbation"],[1,"overlay"],[1,"card","card-review"],[1,"card-header","container__header"],[1,"container__buttonClose"],[1,"fas","fa-times",3,"click"],[1,"card-body"],[3,"trx_id"],[1,"card-footer"],[3,"formGroup"],["formControlName","txtObservationApprobation","cols","30","rows","2",1,"form-control"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],["id","container__Cancelation"],["formControlName","txtObservationCancelation","cols","30","rows","2",1,"form-control"],["id","container__resume"],[1,"container-cards"],[3,"transaction","onShowDetailTrx","onApproveTrx","onDeniedTrx",4,"ngFor","ngForOf"],[3,"transaction","onShowDetailTrx","onApproveTrx","onDeniedTrx"],[1,"container-nothing"]],template:function(t,n){1&t&&(g.bc(0,"div",0),g.bc(1,"h1"),g.Mc(2,"\xd3rdenes de trabajo por aprobar"),g.ac(),g.Lc(3,w,2,1,"div",1),g.Lc(4,S,4,0,"div",2),g.ac(),g.bc(5,"div",3),g.bc(6,"div",4),g.bc(7,"div",5),g.bc(8,"div",6),g.bc(9,"h2"),g.Mc(10),g.ac(),g.bc(11,"div",7),g.bc(12,"a"),g.bc(13,"i",8),g.ic("click",(function(){return n.closePopUp("container__Approbation")})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(14,"div",9),g.Wb(15,"app-transaction-review",10),g.ac(),g.bc(16,"div",11),g.bc(17,"form",12),g.bc(18,"div"),g.bc(19,"legend"),g.Mc(20,"Observaciones de la aprobaci\xf3n"),g.ac(),g.Lc(21,A,2,0,"span",2),g.bc(22,"textarea",13),g.Mc(23,"            "),g.ac(),g.ac(),g.ac(),g.bc(24,"div",14),g.bc(25,"button",15),g.ic("click",(function(){return n.closePopUp("container__Approbation"),n.clearForms()})),g.Mc(26," Cancelar "),g.ac(),g.bc(27,"button",16),g.ic("click",(function(){return n.approveWorkOrder()})),g.Mc(28," Guardar "),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(29,"div",17),g.bc(30,"div",4),g.bc(31,"div",5),g.bc(32,"div",6),g.bc(33,"h2"),g.Mc(34),g.ac(),g.bc(35,"div",7),g.bc(36,"a"),g.bc(37,"i",8),g.ic("click",(function(){return n.closePopUp("container__Cancelation")})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(38,"div",9),g.Wb(39,"app-transaction-review",10),g.ac(),g.bc(40,"div",11),g.bc(41,"form",12),g.bc(42,"legend"),g.Mc(43,"Observaciones de la cancelaci\xf3n"),g.ac(),g.Lc(44,P,2,0,"span",2),g.Wb(45,"textarea",18),g.bc(46,"div",14),g.bc(47,"button",15),g.ic("click",(function(){return n.closePopUp("container__Cancelation"),n.clearForms()})),g.Mc(48," Cancelar "),g.ac(),g.bc(49,"button",16),g.ic("click",(function(){return n.cancelWorkOrder()})),g.Mc(50," Guardar "),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(51,"div",19),g.bc(52,"div",4),g.bc(53,"div",5),g.bc(54,"div",6),g.bc(55,"h2"),g.Mc(56),g.ac(),g.bc(57,"div",7),g.bc(58,"a"),g.bc(59,"i",8),g.ic("click",(function(){return n.closePopUp("container__resume")})),g.ac(),g.ac(),g.ac(),g.ac(),g.bc(60,"div",9),g.Wb(61,"app-transaction-review",10),g.ac(),g.ac(),g.ac(),g.ac(),g.Lc(62,y,1,0,"app-img-loading",2)),2&t&&(g.Jb(3),g.uc("ngIf",n.lsTransactionsToApprove),g.Jb(1),g.uc("ngIf",0==n.lsTransactionsToApprove.length),g.Jb(6),g.Oc(" Aprobar orden de trabajo: ",null!=n.transactionSelected&&null!=n.transactionSelected?n.transactionSelected.code:""," "),g.Jb(5),g.uc("trx_id",n.trx_id),g.Jb(2),g.uc("formGroup",n.frmApprovedTrx),g.Jb(4),g.uc("ngIf",n.frmApprovedTrx.invalid),g.Jb(6),g.uc("disabled",n.frmApprovedTrx.invalid),g.Jb(7),g.Oc(" Cancelar orden de trabajo: ",null!=n.transactionSelected&&null!=n.transactionSelected?n.transactionSelected.code:""," "),g.Jb(5),g.uc("trx_id",n.trx_id),g.Jb(2),g.uc("formGroup",n.frmCancelTrx),g.Jb(3),g.uc("ngIf",n.frmCancelTrx.invalid),g.Jb(5),g.uc("disabled",n.frmCancelTrx.invalid),g.Jb(7),g.Oc(" Resumen orden de trabajo: ",null!=n.transactionSelected&&null!=n.transactionSelected?n.transactionSelected.code:""," "),g.Jb(5),g.uc("trx_id",n.trx_id),g.Jb(1),g.uc("ngIf",n.isAwaiting))},directives:[c.o,x.a,i.B,i.r,i.k,i.c,i.q,i.i,c.n,O,C.a],styles:["#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px 50px;margin-left:250px}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%;overflow:scroll}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}#container__Approbation[_ngcontent-%COMP%], #container__Cancelation[_ngcontent-%COMP%], #container__resume[_ngcontent-%COMP%]{display:none}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}table[_ngcontent-%COMP%]{cursor:pointer;margin-top:80px}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;cursor:pointer;position:relative;left:93%;margin-bottom:20px;top:10px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}.container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.container__buttonClose[_ngcontent-%COMP%]{margin-top:10px}.card-review[_ngcontent-%COMP%]{width:1200px;height:auto}.container-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);row-gap:15px;column-gap:15px}@media only screen and (max-width:600px){#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:10px;margin-left:0}.container-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;row-gap:15px}}.container-nothing[_ngcontent-%COMP%]{display:flex;position:absolute;top:0;left:0;bottom:0;right:0;color:#ccc;margin:auto;justify-content:center;align-items:center}"]}),t})()}]}];let J=(()=>{class t{}return t.\u0275mod=g.Tb({type:t}),t.\u0275inj=g.Sb({factory:function(n){return new(n||t)},imports:[[a.f.forChild(D)],a.f]}),t})();var k=e("Z/wE");let N=(()=>{class t{}return t.\u0275mod=g.Tb({type:t}),t.\u0275inj=g.Sb({factory:function(n){return new(n||t)},imports:[[c.c,i.l,i.w,k.a,J,_.h,T.b]]}),t})()}}]);