(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"7I7t":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("930R");class c{}class a{constructor(){}static validateUserAndCompany(){try{const e=new c,t=JSON.parse(sessionStorage.getItem("sessionUser"));return console.log(t),e.type=t.company.type,e.id=t.company.type==i.a.DEALER||t.company.type==i.a.CLIENT?t.company.id:0,e.usr_id=t.id_user,e}catch(e){console.warn(e)}}static validateUserLogged(){try{return JSON.parse(sessionStorage.getItem("sessionUser")).id_user}catch(e){console.warn(e)}}}},"9w/y":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("tk/3"),c=n("AytR"),a=n("fXoL");let r=(()=>{class e{constructor(e){this.http=e,this.URL_API=c.a.apiUrl+"/FinancialInformation",this.HttpOptions={headers:new i.c({"Content-Type":"application/json"})}}async getClientsWithQuota(){return this.http.get(this.URL_API+"/GetClientsWithQuota").toPromise()}getClientsWithoutQuota(){return this.http.get(this.URL_API+"/GetClientsWithoutQuota")}getFinancialInformationByClient(e){return this.http.get(`${this.URL_API}/GetFinancialInformationByClient?client_id=${e}`)}async validatePaymentVsConsumedQuota(e,t){return this.http.get(`${this.URL_API}/ValidatePaymentVsConsumedQuota?pClient_id=${e}&paymentValue=${t}`).toPromise()}}return e.\u0275fac=function(t){return new(t||e)(a.fc(i.a))},e.\u0275prov=a.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},TO7w:function(e,t,n){"use strict";n.r(t),n.d(t,"WorkOrderManagerModule",(function(){return ke}));var i=n("ofXK"),c=n("3Pt+"),a=n("Z/wE"),r=n("tyNb"),o=n("uswQ"),s=n("KBdt"),l=n("7I7t"),d=n("930R"),u=n("jvTp"),h=n("K9Qb"),p=n("KyVN"),b=n("PSD3"),m=n.n(b),g=n("QgiH"),f=n("fXoL"),_=n("a9jy"),v=n("JP3n"),M=n("FMJ1"),C=n("i5Qh"),x=n("aouF"),y=n("hzby"),S=n("us/p"),w=n("R7St");class I{}var O=n("0x5P"),k=n("2jix"),P=n("U+sL"),W=n("Dhb6"),R=n("xch/"),T=n("9w/y"),D=n("vllv"),A=n("3LUQ"),F=n("XNiG"),B=n("Kj3r"),L=n("/uUt"),V=n("eIep");function E(e,t){if(1&e){const e=f.cc();f.bc(0,"li",4),f.ic("click",(function(){f.Dc(e);const n=t.$implicit;return f.mc(2).setVehicle(n)})),f.bc(1,"span",5),f.Mc(2),f.nc(3,"uppercase"),f.ac(),f.bc(4,"span",6),f.Mc(5),f.nc(6,"titlecase"),f.ac(),f.ac()}if(2&e){const e=t.$implicit;f.Jb(2),f.Nc(f.oc(3,2,e.licensePlate)),f.Jb(3),f.Oc("| ",f.oc(6,4,e.vehicleModel.shortName),"")}}function N(e,t){if(1&e&&(f.bc(0,"ul"),f.Lc(1,E,7,6,"li",3),f.nc(2,"async"),f.ac()),2&e){const e=f.mc();f.Jb(1),f.uc("ngForOf",f.oc(2,1,e.lsVehicleSuggestion$))}}let J=(()=>{class e{constructor(e){this.vehicleService=e,this.description=new F.a,this.vehicleWasSetted=new f.q,this.frmSearchVehicle=new c.j({txtLicensePlate:new c.g("")})}ngOnChanges(e){for(const t in e)"vehicleSelected"==t&&null==this.vehicleSelected&&this.frmSearchVehicle.reset()}ngOnInit(){this.initComponents()}async initComponents(){this.listIsvisible=!1,this.searchVehicles()}searchVehicles(){this.lsVehicleSuggestion$=this.description.pipe(Object(B.a)(300),Object(L.a)(),Object(V.a)(e=>this.vehicleService.getVehiclesByLicensePlate(e)))}setVehicle(e){const{txtLicensePlate:t}=this.frmSearchVehicle.controls;t.setValue(e.licensePlate),this.listIsvisible=!1,this.vehicleService.setVehicle(e),this.vehicleWasSetted.emit(!0)}searchBydescription(e){this.listIsvisible=!0,this.description.next(e)}}return e.\u0275fac=function(t){return new(t||e)(f.Vb(O.a))},e.\u0275cmp=f.Pb({type:e,selectors:[["app-input-search-vehicle"]],inputs:{vehicleSelected:"vehicleSelected"},outputs:{vehicleWasSetted:"vehicleWasSetted"},features:[f.Hb],decls:5,vars:2,consts:[[3,"formGroup"],["type","text","formControlName","txtLicensePlate","placeholder","Placa ...",1,"form-control",3,"input"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"container__licensePlate"],[1,"container__vehicleModel"]],template:function(e,t){1&e&&(f.bc(0,"form",0),f.bc(1,"label"),f.Mc(2,"Placa:"),f.ac(),f.bc(3,"input",1),f.ic("input",(function(e){return t.searchBydescription(e.target.value)})),f.ac(),f.Lc(4,N,3,3,"ul",2),f.ac()),2&e&&(f.uc("formGroup",t.frmSearchVehicle),f.Jb(4),f.uc("ngIf",t.listIsvisible))},directives:[c.B,c.r,c.k,c.c,c.q,c.i,i.o,i.n],pipes:[i.b,i.y,i.x],styles:["","ul[_ngcontent-%COMP%]{position:absolute;z-index:3}li[_ngcontent-%COMP%]{list-style:none;padding:5px;border-bottom:1px solid grey;cursor:pointer;width:450px;background-color:#fff}li[_ngcontent-%COMP%]:hover{background-color:#87cefa;color:#fff}.container__document[_ngcontent-%COMP%]{display:inline-block;width:100px;height:auto}"]}),e})();function U(e,t){if(1&e&&(f.bc(0,"option",2),f.Mc(1),f.nc(2,"uppercase"),f.ac()),2&e){const e=t.$implicit;f.uc("value",e.id),f.Jb(1),f.Nc(f.oc(2,2,e.name))}}let j=(()=>{class e{constructor(e){this.branchService=e,this.branchWasSetted=new f.q,this.frmBranch=new c.j({cmbBranch:new c.g("")})}ngOnChanges(e){var t;for(const n in e)"dealer"==n&&this.getListBranchByDealer(null===(t=this.dealer)||void 0===t?void 0:t.id)}ngOnInit(){this.initComponents()}initComponents(){var e;this.getListBranchByDealer(null===(e=this.dealer)||void 0===e?void 0:e.id)}async getListBranchByDealer(e){this.branchService.getBranchs(e,"DEALER").subscribe(e=>{this.lsBranch=e})}setBranch(e){const t=this.lsBranch.find(t=>t.id==e.value);this.branchService.setBranchSelected(t),this.branchWasSetted.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(f.Vb(P.a))},e.\u0275cmp=f.Pb({type:e,selectors:[["app-branch-by-dealer"]],inputs:{branchSelected:"branchSelected",dealer:"dealer"},outputs:{branchWasSetted:"branchWasSetted"},features:[f.Hb],decls:7,vars:3,consts:[[3,"formGroup"],["formControlName","cmbBranch",1,"browser-default","custom-select",3,"change"],[3,"value"],[3,"value",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(f.bc(0,"form",0),f.bc(1,"label"),f.Mc(2,"Sucursal"),f.ac(),f.bc(3,"select",1),f.ic("change",(function(e){return t.setBranch(e.target)})),f.bc(4,"option",2),f.Mc(5,"Seleccione ..."),f.ac(),f.Lc(6,U,3,4,"option",3),f.ac(),f.ac()),2&e&&(f.uc("formGroup",t.frmBranch),f.Jb(4),f.uc("value",0),f.Jb(2),f.uc("ngForOf",t.lsBranch))},directives:[c.B,c.r,c.k,c.x,c.q,c.i,c.u,c.A,i.n],pipes:[i.y],styles:["select[_ngcontent-%COMP%]{cursor:pointer}"]}),e})();function q(e,t){if(1&e&&(f.bc(0,"option",2),f.Mc(1),f.nc(2,"uppercase"),f.ac()),2&e){const e=t.$implicit;f.uc("value",e.id),f.Jb(1),f.Oc(" ",f.oc(2,2,e.name)," ")}}let $=(()=>{class e{constructor(e){this.maintenanceRoutineService=e,this.lsRoutine=[],this.lsRoutinesFiltered=[],this.maintenanceRoutineSelected=[],this.vehicleModel=null,this.routineWasSetted=new f.q,this.areRoutineFiltered=!1,this.onRoutineWasChanged=new f.q,this.frmRoutineByVehicleModel=new c.j({cmbRoutineByVehicleModel:new c.g("Seleccione")})}set setVehicleModel(e){this.vehicleModel=e,this.vehicleModel&&this.getListMaintenanceRoutines(this.vehicleModel.id)}set setRoutineFiltered(e){this.areRoutineFiltered=e,this.areRoutineFiltered&&(this.lsRoutinesFiltered=this.filterRoutinesWithoutItems(this.lsRoutine))}ngOnChanges(e){for(const t in e)"vehicleModel"==t&&(null==this.vehicleModel?this.frmRoutineByVehicleModel.controls.cmbRoutineByVehicleModel.setValue(0):this.getListMaintenanceRoutines(this.vehicleModel.id))}ngOnInit(){}getListMaintenanceRoutines(e){try{this.maintenanceRoutineService.getMaintenanceRoutineByModel(e).subscribe(e=>{this.lsRoutine=e,this.lsRoutinesFiltered=this.lsRoutine,this.areRoutineFiltered&&(this.lsRoutinesFiltered=this.filterRoutinesWithoutItems(this.lsRoutine))})}catch(t){console.warn(t)}}setRoutine(e){const t=this.lsRoutine.find(t=>t.id==e.value);this.maintenanceRoutineService.setRoutine(t),this.routineWasSetted.emit(!0),this.onRoutineWasChanged.emit(t)}filterRoutinesWithoutItems(e){let t=[];if(null!=e){t=e.filter(e=>null!=e.lsItems&&e.lsItems.length>0),console.log("filterRoutinesWithoutItems"),console.log(e);const n=e.find(e=>21==e.frequency.id);null!=n&&t.push(n)}return t}}return e.\u0275fac=function(t){return new(t||e)(f.Vb(W.a))},e.\u0275cmp=f.Pb({type:e,selectors:[["app-routines-by-vehicle-model"]],inputs:{setVehicleModel:["vehicleModel","setVehicleModel"],countChanges:"countChanges",setRoutineFiltered:["areRoutineFiltered","setRoutineFiltered"]},outputs:{routineWasSetted:"routineWasSetted",onRoutineWasChanged:"onRoutineWasChanged"},features:[f.Hb],decls:7,vars:3,consts:[[3,"formGroup"],["formControlName","cmbRoutineByVehicleModel",1,"browser-default","custom-select",3,"change"],[3,"value"],[3,"value",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(f.bc(0,"form",0),f.bc(1,"label"),f.Mc(2,"Rutina de mantenimiento"),f.ac(),f.bc(3,"select",1),f.ic("change",(function(e){return t.setRoutine(e.target)})),f.bc(4,"option",2),f.Mc(5,"Seleccione ..."),f.ac(),f.Lc(6,q,3,4,"option",3),f.ac(),f.ac()),2&e&&(f.uc("formGroup",t.frmRoutineByVehicleModel),f.Jb(4),f.uc("value",0),f.Jb(2),f.uc("ngForOf",t.lsRoutinesFiltered))},directives:[c.B,c.r,c.k,c.x,c.q,c.i,c.u,c.A,i.n],pipes:[i.y],styles:["select[_ngcontent-%COMP%]{cursor:pointer}"]}),e})();var z=n("pMMx"),G=n("oOf3");function Q(e,t){if(1&e){const e=f.cc();f.bc(0,"i",15),f.ic("click",(function(){return f.Dc(e),f.mc().clearFilter()})),f.ac()}}function H(e,t){if(1&e){const e=f.cc();f.bc(0,"tr"),f.bc(1,"td"),f.Mc(2),f.ac(),f.bc(3,"td"),f.bc(4,"label",16),f.bc(5,"input",17),f.ic("click",(function(n){f.Dc(e);const i=t.$implicit;return f.mc().pickItemToAdd(n.target,i)})),f.ac(),f.Wb(6,"span",18),f.ac(),f.ac(),f.bc(7,"td"),f.bc(8,"Label",19),f.Mc(9),f.nc(10,"slice"),f.nc(11,"titlecase"),f.ac(),f.ac(),f.bc(12,"td"),f.Mc(13),f.ac(),f.bc(14,"td"),f.Mc(15),f.nc(16,"currency"),f.ac(),f.ac()}if(2&e){const e=t.index,n=t.$implicit,i=f.mc();f.Jb(2),f.Nc(e+1),f.Jb(3),f.uc("id",i.getCheckBoxId(n.id)),f.Jb(3),f.uc("for",i.getCheckBoxId(n.id)),f.Jb(1),f.Oc(" ",f.qc(10,6,f.oc(11,10,n.code+" - "+n.name),0,80)," "),f.Jb(4),f.Nc(n.presentationUnit.shortName),f.Jb(2),f.Nc(f.oc(16,12,n.referencePrice))}}function K(e,t){if(1&e&&(f.bc(0,"li"),f.Mc(1),f.nc(2,"slice"),f.nc(3,"titlecase"),f.Wb(4,"hr"),f.ac()),2&e){const e=t.$implicit;f.Jb(1),f.Oc("",f.qc(2,1,f.oc(3,5,e.code+" - "+e.name),0,40)," ")}}const Y=function(e){return{itemsPerPage:5,currentPage:e}};let Z=(()=>{class e{constructor(){this.newItemsWasSetted=new f.q,this.addItemsWasCanceled=new f.q,this.p=1,this.clearFilterIsVisible=!1,this.lsItemsToAddSelected=[],this.countChanges=0}set setLsMaintenanceItems(e){this.lsMaintenanceItems=e,this.turnOffCheckBoxes(),this.lsItemsToAddSelected=[],this.lsMaintenanceItemsTemp=this.lsMaintenanceItems}ngOnInit(){this.lsMaintenanceItemsTemp=this.lsMaintenanceItems}pickItemToAdd(e,t){if(e.checked)this.lsItemsToAddSelected.push(t);else{const e=this.lsItemsToAddSelected.find(e=>e.id==t.id),n=this.lsItemsToAddSelected.indexOf(e);this.lsItemsToAddSelected.splice(n,1)}}getCheckBoxId(e){return"chk_add_"+e}filterItems(e){try{this.validateItemsChecked();const t=e.target.value.toString().toLowerCase();""!=t.trim()?(this.clearFilterIsVisible=!0,this.lsMaintenanceItemsTemp=this.lsMaintenanceItems.filter(e=>e.code.toLowerCase().includes(t)||e.name.toLowerCase().includes(t))):this.clearFilter()}catch(t){console.warn(t)}}clearFilter(){try{this.validateItemsChecked(),this.lsMaintenanceItemsTemp=this.lsMaintenanceItems,document.querySelector("#txtFilter").value="",this.clearFilterIsVisible=!1,this.p=1}catch(e){}}validateItemsChecked(){setTimeout(()=>{this.lsItemsToAddSelected.forEach(e=>{try{const t="#"+this.getCheckBoxId(e.id);document.querySelector(t).checked=!0}catch(t){}})},300)}addItemsToWorkOrder(){this.newItemsWasSetted.emit(this.lsItemsToAddSelected)}cancelAddItems(){confirm("\xbfEst\xe1 seguro que desea cancelar la adici\xf3n de items?, s\xed lo hace perdera todo el avance registrado")&&(this.lsItemsToAddSelected=[],this.addItemsWasCanceled.emit(!0))}turnOffCheckBoxes(){this.lsItemsToAddSelected.forEach(e=>{try{const t="#"+this.getCheckBoxId(e.id);document.querySelector(t).checked=!1}catch(t){}})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=f.Pb({type:e,selectors:[["app-tbl-items-to-add"]],inputs:{setLsMaintenanceItems:["lsMaintenanceItems","setLsMaintenanceItems"],countChanges:"countChanges"},outputs:{newItemsWasSetted:"newItemsWasSetted",addItemsWasCanceled:"addItemsWasCanceled"},decls:38,vars:8,consts:[[1,"container__content"],[1,"container__row"],[1,"container___col"],["type","text","id","txtFilter",1,"form-control",3,"input"],["class","fas fa-times clear_filter","title","Borrar filtro",3,"click",4,"ngIf"],["id","container__table_resume"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"paginationContainer"],[3,"pageChange"],["id","container__resume"],[1,"title_resume"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["title","Borrar filtro",1,"fas","fa-times","clear_filter",3,"click"],[1,"container__checkbox"],["type","checkbox",3,"id","click"],[1,"checkmark"],[3,"for"]],template:function(e,t){1&e&&(f.bc(0,"div",0),f.bc(1,"div",1),f.bc(2,"div",2),f.bc(3,"label"),f.Mc(4,"Nombre / C\xf3digo"),f.ac(),f.bc(5,"input",3),f.ic("input",(function(e){return t.filterItems(e)})),f.ac(),f.Lc(6,Q,1,0,"i",4),f.ac(),f.ac(),f.Wb(7,"hr"),f.bc(8,"div",5),f.bc(9,"div"),f.bc(10,"table",6),f.bc(11,"thead"),f.bc(12,"th"),f.Mc(13,"#"),f.ac(),f.bc(14,"th"),f.Mc(15,"-"),f.ac(),f.bc(16,"th"),f.Mc(17,"C\xf3digo / Nombre"),f.ac(),f.bc(18,"th"),f.Mc(19,"Presentaci\xf3n"),f.ac(),f.bc(20,"th"),f.Mc(21,"Valor sin impuestos"),f.ac(),f.ac(),f.bc(22,"tbody"),f.Lc(23,H,17,14,"tr",7),f.nc(24,"paginate"),f.ac(),f.ac(),f.bc(25,"div",8),f.bc(26,"pagination-controls",9),f.ic("pageChange",(function(e){return t.p=e,t.validateItemsChecked()})),f.ac(),f.ac(),f.ac(),f.bc(27,"div",10),f.bc(28,"legend",11),f.Mc(29,"Resumen"),f.ac(),f.bc(30,"ol"),f.Lc(31,K,5,7,"li",7),f.ac(),f.ac(),f.ac(),f.Wb(32,"hr"),f.bc(33,"div",12),f.bc(34,"button",13),f.ic("click",(function(){return t.cancelAddItems()})),f.Mc(35,"Cancelar"),f.ac(),f.bc(36,"button",14),f.ic("click",(function(){return t.addItemsToWorkOrder()})),f.Mc(37,"A\xf1adir items"),f.ac(),f.ac(),f.ac()),2&e&&(f.Jb(6),f.uc("ngIf",t.clearFilterIsVisible),f.Jb(17),f.uc("ngForOf",f.pc(24,3,t.lsMaintenanceItemsTemp,f.xc(6,Y,t.p))),f.Jb(8),f.uc("ngForOf",t.lsItemsToAddSelected))},directives:[i.o,i.n,G.c],pipes:[G.b,i.w,i.x,i.d],styles:[".container__content[_ngcontent-%COMP%]{width:1248px;height:auto}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr!important;grid-template-rows:1fr;justify-content:space-between}label[_ngcontent-%COMP%]{cursor:pointer}.clear_filter[_ngcontent-%COMP%]{position:absolute;z-index:50;top:160px;left:95%;color:red}.container___col[_ngcontent-%COMP%]{width:100%}input[_ngcontent-%COMP%]{width:inherit}#container__table_resume[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}#container__resume[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px 10px 10px 20px;width:400px;height:500px;overflow-y:scroll;margin-right:20px}.title_resume[_ngcontent-%COMP%]{margin-bottom:20px}",'.container__checkbox[_ngcontent-%COMP%]{display:block;position:relative;padding-left:3px;padding-right:3px;margin-bottom:12px;cursor:pointer;font-size:22px;-webkit-user-select:none;user-select:none}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:20px;width:20px;background-color:#eee;border:1px solid #686d76;border-radius:5px}.container__checkbox[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{background-color:#ccc}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:#81b214;border-radius:50%;border:none}.checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled ~ .checkmark[_ngcontent-%COMP%]{border:1px solid #686d76;border-radius:5px}.container__checkbox[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:8px;top:5px;width:5px;height:10px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg)}',"select[_ngcontent-%COMP%]{cursor:pointer}.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}.btn-add[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{cursor:pointer}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;position:relative;left:93%;margin-bottom:20px;top:30px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px;margin-left:250px}.container__row_buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;justify-content:right;margin-top:30px}.container__row_buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin-bottom:20px}@media only screen and (max-width:600px){.col-mobile-hide[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{left:80vw}}"]}),e})();var X=n("KBxE"),ee=n("9Wwi");function te(e,t){1&e&&(f.bc(0,"div",44),f.bc(1,"p"),f.Mc(2,"* La sucursal es un campo obligatorio"),f.ac(),f.ac())}function ne(e,t){1&e&&(f.bc(0,"div",44),f.bc(1,"p"),f.Mc(2,"* La rutina de mantenimiento es un campo obligatorio"),f.ac(),f.ac())}function ie(e,t){1&e&&(f.bc(0,"div",45),f.bc(1,"span"),f.Mc(2,"No se puede guardar la orden de trabajo puesto que hay campos obligatorios sin diligenciar"),f.ac(),f.ac())}function ce(e,t){if(1&e){const e=f.cc();f.bc(0,"app-alert-error",46),f.ic("onAlertWasClose",(function(){return f.Dc(e),f.mc().closeErrorMessage()})),f.ac()}if(2&e){const e=f.mc();f.uc("title",e.errorTitle)("errorMessage",e.errorMessageApi)}}function ae(e,t){1&e&&f.Wb(0,"app-img-loading")}const re=function(){return[]};let oe=(()=>{class e{constructor(e,t,n,i,a,r,o,s,l,d,u,h,p,b){this.ClientService=e,this.vehicleService=t,this.contractService=n,this.branchService=i,this.maintenanceRoutineService=a,this.maintenanceItemService=r,this.notificationService=o,this.movementService=s,this.transactionService=l,this.quotaService=d,this.dealerService=u,this.maintenanceItemManagerService=h,this.router=p,this.alertService=b,this.lsMaintenanceItems=[],this.lsMaintenanceItemsSelected=[],this.ORDEN_DE_TRABAJO=4,this.workOrderWasCanceled=new f.q,this.workOrderWasSaved=new f.q,this.isErrorVisible=!1,this.errorTitle="",this.errorMessageApi="",this.frmWorkOrder=new c.j({txtYear:new c.g(""),txtMileage:new c.g(""),txtBrand:new c.g(""),txtVehicleType:new c.g(""),txtVehicleModel:new c.g(""),txtClientDocument:new c.g(""),txtClient:new c.g(""),txtContract:new c.g(""),txtDealer:new c.g(""),txtObservation:new c.g("",[c.z.required,c.z.pattern(/^(\s+\S+\s*)*(?!\s).*$/)]),txtCurrentQuota:new c.g(""),txtConsumedQuota:new c.g(""),txtInTransitQuota:new c.g("")}),this.totalTaxes=0,this.totalWithoutTaxes=0,this.totalWithoutTaxesAndDiscount=0,this.totalDiscount=0,this.fieldBranchIsInvalid=!0,this.fieldMaintenanceRoutineIsInvalid=!0}ngOnChanges(e){this.clearBufferForm(),this.getDealer()}clearBufferForm(){this.frmWorkOrder.reset(),this.vehicleSelected=null,this.vehicleModelSelected=null,this.branchSelected=null,this.contractSelected=null,this.routineSelected=null,this.lsMaintenanceItems=[],this.lsMaintenanceItemsSelected=[],this.getDealer()}ngOnInit(){this.getDealer(),this.initComponents()}getDealer(){const e=JSON.parse(sessionStorage.getItem("sessionUser"));this.dealerService.getDealerById(e.company.id).subscribe(e=>{this.dealer=e,this.frmWorkOrder.controls.txtDealer.setValue(this.dealer.name.toUpperCase())})}initComponents(){this.oCountChanges=0,this.isAwaiting=!1,this.sharedFunctions=new w.a,this.getLsMovements()}getPricesByContract(e){this.maintenanceItemService.getPricesByContract(e).subscribe(e=>{this.pricesByContract=e;try{if(!this.contractSelected.client.contractualInformation)throw Error("El cliente a\xfan no tiene configurado un contrato con Renting Automayor, por favor comuniquese con el administrador de la plataforma.")}catch(t){this.clearFrmWorkOrder(),this.resetItemsToRoutine(),this.resetMaintenanceItems(),this.resetMaintenanceRoutines(),this.isErrorVisible=!0,this.errorTitle="Error validando la informaci\xf3n del cliente asociado a la placa",this.errorMessageApi=t}})}getLsMovements(){try{this.movementService.getMovements().then(e=>{this.lsMovements=e})}catch(e){console.warn(e)}}async searchVehicleOwner(e){try{this.ClientService.getClientById(e).then(e=>{})}catch(t){console.warn(t)}}async SetDataInForm(){try{const{txtYear:e,txtMileage:t,txtBrand:n,txtVehicleType:i,txtVehicleModel:c,txtClient:a,txtClientDocument:r,txtContract:o,txtCurrentQuota:s,txtConsumedQuota:l,txtInTransitQuota:d}=this.frmWorkOrder.controls;if(this.resetItemsToRoutine(),this.resetMaintenanceItems(),this.vehicleSelected=this.vehicleService.getVehicle(),1!=this.vehicleSelected.vehicleState.id)throw new Error("El veh\xedculo que seleccion\xf3 se encuentra en un estado INACTIVO, por favor comuniquese con el administrador");this.contractService.getContractByVehicleId(this.vehicleSelected.id).then(u=>{if(this.contractSelected=u,null==this.contractSelected)throw new Error("El veh\xedculo que ingres\xf3 no tienen un contrato v\xednculado, por favor comuniquese con el administrador");if(this.contractSelected.contractState.id!=S.a.ACTIVO)throw new Error(`El veh\xedculo que intenta asociar cuenta con un contrato en estado: ${this.contractSelected.contractState.name} , por tal motivo, NO se puede generar una orden de trabajo. Por favor comuniquese con el administrador.`);e.setValue(this.vehicleSelected.year),t.setValue(this.sharedFunctions.formatNumberToString(this.vehicleSelected.mileage)),n.setValue(this.vehicleSelected.vehicleModel.brand.name.toUpperCase()),i.setValue(this.vehicleSelected.vehicleModel.type.name.toUpperCase()),c.setValue(this.vehicleSelected.vehicleModel.shortName.toUpperCase()),r.setValue(this.contractSelected.client.document),a.setValue(this.contractSelected.client.name.toUpperCase()),o.setValue(`${this.contractSelected.code} - ${this.contractSelected.name}`),this.vehicleModelSelected=this.vehicleSelected.vehicleModel,this.getPricesByContract(this.contractSelected.id),this.quotaService.getFinancialInformationByClient(this.contractSelected.client.id).subscribe(e=>{if(null==e||null==e)throw new Error("El cliente no tiene un cupo asignado a\xfan, por favor comuniquese con el administrador para que se realice la correspondiente gesti\xf3n.");{const t=e;s.setValue(this.sharedFunctions.formatNumberToString(parseFloat(t.currentQuota.toString()))),l.setValue(this.sharedFunctions.formatNumberToString(parseFloat(t.consumedQuota.toString()))),d.setValue(this.sharedFunctions.formatNumberToString(parseFloat(t.inTransitQuota.toString())))}},e=>{this.clearFrmWorkOrder(),this.resetItemsToRoutine(),this.resetMaintenanceItems(),this.resetMaintenanceRoutines(),this.isErrorVisible=!0,this.errorTitle="Error validando la informaci\xf3n del cliente.",this.errorMessageApi=e})}).catch(e=>{this.clearFrmWorkOrder(),this.resetItemsToRoutine(),this.resetMaintenanceItems(),this.resetMaintenanceRoutines(),this.isErrorVisible=!0,this.errorTitle="Error validando la informaci\xf3n del veh\xedculo",this.errorMessageApi=e})}catch(e){console.warn(e),this.isErrorVisible=!0,this.errorTitle="Error validando la informaci\xf3n del veh\xedculo",this.errorMessageApi=e}}setBranchSelected(){this.branchSelected=this.branchService.getBranchSelected(),this.fieldBranchIsInvalid=null==this.branchSelected||null==this.branchSelected}showMaintenanceItems(e){if(this.resetItemsToRoutine(),this.routineSelected=e,null==this.routineSelected||null==this.routineSelected)this.fieldMaintenanceRoutineIsInvalid=!0,this.lsMaintenanceItems=[],this.lsMaintenanceItemsSelected=[];else{let t=null;this.maintenanceItemService.getItemRAAdministration().subscribe(n=>{t=n,this.fieldMaintenanceRoutineIsInvalid=!1,this.lsMaintenanceItems=e.lsItems,this.lsMaintenanceItems.push(t),this.lsMaintenanceItemsSelected=this.lsMaintenanceItems,this.updateReferencePrices(this.lsMaintenanceItems,this.pricesByContract.lsMaintenanceItems)})}}updateReferencePrices(e,t){const n=[];e.forEach(e=>{try{const i=t.find(t=>t.id==e.id);n.push(i)}catch(i){console.log("no se encontro item\n        para actualizar precio")}}),console.log("updateReferencePrices"),console.log(n),this.lsMaintenanceItems=this.maintenanceItemManagerService.updatePrices(e,n)}resetItemsToRoutine(){this.lsMaintenanceItemsSelected=[]}resetMaintenanceItems(){this.lsMaintenanceItems=[]}resetMaintenanceRoutines(){this.vehicleModelSelected=new I,this.vehicleModelSelected.id=0,this.vehicleService.setVehicleModelSelected(null)}addItemToRoutine(e){null!=this.lsMaintenanceItemsSelected&&null!=this.lsMaintenanceItemsSelected||this.resetItemsToRoutine(),this.lsMaintenanceItemsSelected.push(e)}deleteItemToRoutine(e){const t=this.lsMaintenanceItemsSelected.find(t=>t.id==e.id),n=this.lsMaintenanceItemsSelected.indexOf(t);this.lsMaintenanceItemsSelected.splice(n,1)}clearFrmWorkOrder(){this.frmWorkOrder.reset(),this.fieldBranchIsInvalid=!0,this.fieldMaintenanceRoutineIsInvalid=!0}formatNumberToString(e){return this.sharedFunctions.formatNumberToString(e)}async sendEmail(e){const{contacts:t}=await this.ClientService.getClientById(this.contractSelected.client.id),n=await this.transactionService.getTransactionsByDealerOrClient(e.headerDetails.dealer.id,null,null,null,null,null,null).toPromise(),i={nameMessage:"Fleet Service",emailReceiver:t.filter(e=>1==e.mustNotify).map(e=>e.email),typemessage:e.movement.id,nOrderwork:n[0].code,nDealer:e.headerDetails.dealer.name};i.emailReceiver.length>0&&this.notificationService.sendMail(i).subscribe(e=>{})}async saveWorkOrder(){try{this.alertService.confirm("\xbfEst\xe1 seguro de guardar los datos de esta Orden de trabajo?",()=>{const e=this.setDataToWorkOrder();this.isAwaiting=!0,this.quotaService.getFinancialInformationByClient(e.client.id).subscribe(t=>{parseFloat(t.currentQuota.toString())-e.value>0?this.transactionService.processTransaction(e).subscribe(t=>{const n=t;n.response&&(this.sendEmail(e),this.alertService.succes(n.message),this.clearBufferForm(),this.isAwaiting=!1,this.workOrderWasSaved.emit(!0))}):(this.isAwaiting=!1,this.isErrorVisible=!0,this.errorTitle="Error intentando procesar la \xf3rden de trabajo",this.errorMessageApi="\xa1No se puede procesar esta \xf3rden de trabajo puesto que el cliente no cuenta con el suficiente cupo disponible!")})})}catch(e){this.alertService.error(e),this.isErrorVisible=!0,this.errorTitle="Error intentando procesar la \xf3rden de trabajo",this.errorMessageApi=e}}setDataToWorkOrder(){try{const{txtObservation:e,txtMileage:t}=this.frmWorkOrder.controls,n=new s.a;n.movement=this.lsMovements.find(e=>e.id==this.ORDEN_DE_TRABAJO),n.valueWithoutDiscount=this.totalWithoutTaxes,n.discountValue=this.totalDiscount,n.valueWithDiscountWithoutTaxes=this.totalWithoutTaxesAndDiscount,n.taxesValue=this.totalTaxes,n.value=this.totalRoutine,n.client=this.contractSelected.client,n.usu_id=l.a.validateUserLogged();const i=new h.a;if(i.dealer=this.dealer,null==this.branchSelected||null==this.branchSelected)throw new Error("La sucursal es un dato obligatorio para poder cerrar la orden de trabajo");if(i.branch=this.branchSelected,null==this.vehicleSelected||null==this.vehicleSelected)throw new Error("El veh\xedculo ingresado no es v\xe1lido, por favor rectifique la placa");i.vehicle=this.vehicleSelected,i.vehicle.mileage=t.value.replace(/\,/g,""),null==this.routineSelected||null==this.routineSelected?this.fieldMaintenanceRoutineIsInvalid=!0:i.maintenanceRoutine=this.routineSelected,i.contract=this.contractSelected,n.headerDetails=i,n.lsItems=this.lsMaintenanceItemsSelected;const c=[],a=new p.a,r=e.value;return""!=r.toString().trim()&&(a.description=r,a.usu_id=l.a.validateUserLogged(),c.push(a)),n.lsObservations=c,n}catch(e){return this.isErrorVisible=!0,this.errorTitle="Error inentando procesar la \xf3rden de trabajo.",this.errorMessageApi=e,null}}formatMileageToString(e){const t=e.target.value.toString().replace(/\,/g,"");e.target.value=this.formatNumberToString(t)}closeWorkOrder(){confirm("\xbfest\xe1 seguro que desea cerrar la orden de trabajo?, s\xed lo realiza se perderan todos los cambios consignados ac\xe1")&&(this.clearFrmWorkOrder(),this.clearBufferForm(),this.workOrderWasCanceled.emit(!0))}closePopUp(e){document.getElementById(e).style.display="none"}openPopUp(e){this.oCountChanges+=1,document.getElementById(e).style.display="block"}goToUp(){window.scroll(0,0)}addNewMaintenanceItemsToRoutine(e){e.forEach(e=>{try{this.lsMaintenanceItems.find(t=>t.id==e.id)?console.warn("[addNewMaintenanceItemsToRoutine]: Ya existe el item seleccionado en la rutina"):(e.amount=0,this.lsMaintenanceItems.unshift(e))}catch(t){console.warn(t)}}),window.scroll(0,1e3),this.closePopUp("container__addItems")}calculateDiscount(e){}setItemsToRoutine(e){this.lsMaintenanceItemsSelected=e,console.log("Items selecccionados para la rutina"),console.log(this.lsMaintenanceItemsSelected)}setTotalRoutine(e){this.totalWithoutTaxesAndDiscount=e.valueWithDiscountWithoutTaxes,this.totalWithoutTaxes=e.valueWithoutDiscount,this.totalTaxes=e.taxesValue,this.totalDiscount=e.discountValue,this.totalRoutine=e.value}closeErrorMessage(){this.isErrorVisible=!1,this.workOrderWasCanceled.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(f.Vb(C.a),f.Vb(O.a),f.Vb(k.a),f.Vb(P.a),f.Vb(W.a),f.Vb(R.a),f.Vb(v.a),f.Vb(x.a),f.Vb(_.a),f.Vb(T.a),f.Vb(M.a),f.Vb(D.a),f.Vb(r.b),f.Vb(A.a))},e.\u0275cmp=f.Pb({type:e,selectors:[["app-work-order"]],outputs:{workOrderWasCanceled:"workOrderWasCanceled",workOrderWasSaved:"workOrderWasSaved"},features:[f.Hb],decls:111,vars:17,consts:[[1,"card"],[3,"formGroup"],["id","container__header",1,"card-header"],[1,"container__buttonClose"],[3,"click"],[1,"fas","fa-times"],[1,"card-body"],["role","alert",1,"alert","alert-primary"],[1,"container__row"],[1,"container__col"],[3,"vehicleSelected","vehicleWasSetted"],["type","number","formControlName","txtYear","placeholder","Modelo","disabled","",1,"form-control"],["type","text","formControlName","txtMileage","placeholder","Kilometraje",1,"form-control",3,"input"],["type","text","formControlName","txtBrand","placeholder","Marca","disabled","",1,"form-control"],["type","text","formControlName","txtVehicleType","placeholder","Tipo","disabled","",1,"form-control"],["type","text","formControlName","txtVehicleModel","placeholder","L\xednea","disabled","",1,"form-control"],["type","text","formControlName","txtClientDocument","placeholder","NIT ...","disabled","",1,"form-control"],["type","text","formControlName","txtClient","placeholder","Cliente ...","disabled","",1,"form-control"],["type","text","formControlName","txtContract","placeholder","Contrato ...","disabled","",1,"form-control"],["type","text","formControlName","txtCurrentQuota","placeholder","Cupo disponible ...","disabled","",1,"form-control"],["type","text","formControlName","txtConsumedQuota","placeholder","Cupo consumido ...","disabled","",1,"form-control"],["type","text","formControlName","txtInTransitQuota","placeholder","Cupo en tr\xe1nsito ...","disabled","",1,"form-control"],["type","text","formControlName","txtDealer","placeholder","Concesionario ...","disabled","",1,"form-control"],[3,"dealer","branchSelected","branchWasSetted"],["class","error",4,"ngIf"],[3,"areRoutineFiltered","vehicleModel","onRoutineWasChanged"],[1,"btn-add","btn-info",3,"click"],[1,"fas","fa-plus"],[1,"container-table-items"],[3,"maintenanceItems","maintenanceItemsSelected","contract","onItemsWereSelected","onRoutineWasCalculated"],["formControlName","txtObservation","cols","30","rows","2",1,"form-control"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],["class","container__infoError","id","cont_error_add_work_order",4,"ngIf"],["id","container__addItems"],[1,"overlay"],[1,"card","card-review"],[1,"card-header","container__header"],[1,"fas","fa-times",3,"click"],["id","container__tableAddNewItems",1,"card-body"],[3,"lsMaintenanceItems","newItemsWasSetted","addItemsWasCanceled"],[3,"title","errorMessage","onAlertWasClose",4,"ngIf"],[4,"ngIf"],[1,"error"],["id","cont_error_add_work_order",1,"container__infoError"],[3,"title","errorMessage","onAlertWasClose"]],template:function(e,t){1&e&&(f.bc(0,"div",0),f.bc(1,"form",1),f.bc(2,"div",2),f.bc(3,"legend"),f.Mc(4,"Nueva orden de trabajo"),f.ac(),f.bc(5,"div",3),f.bc(6,"a",4),f.ic("click",(function(){return t.closeWorkOrder()})),f.Wb(7,"i",5),f.ac(),f.ac(),f.ac(),f.bc(8,"div",6),f.bc(9,"legend"),f.Mc(10,"Datos del veh\xedculo"),f.ac(),f.bc(11,"div",7),f.Mc(12," \xa1 No se te olvide actualizar el kilometraje del veh\xedculo ! "),f.ac(),f.bc(13,"div",8),f.bc(14,"div",9),f.bc(15,"app-input-search-vehicle",10),f.ic("vehicleWasSetted",(function(){return t.SetDataInForm()})),f.ac(),f.ac(),f.bc(16,"div",9),f.bc(17,"label"),f.Mc(18,"Modelo"),f.ac(),f.Wb(19,"input",11),f.ac(),f.bc(20,"div",9),f.bc(21,"label"),f.Mc(22,"Kilometraje"),f.ac(),f.bc(23,"input",12),f.ic("input",(function(e){return t.formatMileageToString(e)})),f.ac(),f.ac(),f.ac(),f.bc(24,"div",8),f.bc(25,"div",9),f.bc(26,"label"),f.Mc(27,"Marca"),f.ac(),f.Wb(28,"input",13),f.ac(),f.bc(29,"div",9),f.bc(30,"label"),f.Mc(31,"Tipo"),f.ac(),f.Wb(32,"input",14),f.ac(),f.bc(33,"div",9),f.bc(34,"label"),f.Mc(35,"L\xednea"),f.ac(),f.Wb(36,"input",15),f.ac(),f.ac(),f.Wb(37,"hr"),f.bc(38,"legend"),f.Mc(39,"Datos del cliente"),f.ac(),f.bc(40,"div",8),f.bc(41,"div",9),f.bc(42,"label"),f.Mc(43,"Documento"),f.ac(),f.Wb(44,"input",16),f.ac(),f.bc(45,"div",9),f.bc(46,"label"),f.Mc(47,"Nombre"),f.ac(),f.Wb(48,"input",17),f.ac(),f.bc(49,"div",9),f.bc(50,"label"),f.Mc(51,"Contrato"),f.ac(),f.Wb(52,"input",18),f.ac(),f.ac(),f.bc(53,"div",8),f.bc(54,"div",9),f.bc(55,"label"),f.Mc(56,"Cupo disponible"),f.ac(),f.Wb(57,"input",19),f.ac(),f.bc(58,"div",9),f.bc(59,"label"),f.Mc(60,"Cupo consumido"),f.ac(),f.Wb(61,"input",20),f.ac(),f.bc(62,"div",9),f.bc(63,"label"),f.Mc(64,"Cupo en tr\xe1nsito"),f.ac(),f.Wb(65,"input",21),f.ac(),f.ac(),f.Wb(66,"hr"),f.bc(67,"legend"),f.Mc(68,"Datos de la orden"),f.ac(),f.bc(69,"div",8),f.bc(70,"div",9),f.bc(71,"label"),f.Mc(72,"Concesionario"),f.ac(),f.Wb(73,"input",22),f.ac(),f.bc(74,"div",9),f.bc(75,"app-branch-by-dealer",23),f.ic("branchWasSetted",(function(){return t.setBranchSelected()})),f.ac(),f.Lc(76,te,3,0,"div",24),f.ac(),f.bc(77,"div",9),f.bc(78,"app-routines-by-vehicle-model",25),f.ic("onRoutineWasChanged",(function(e){return t.showMaintenanceItems(e)})),f.ac(),f.Lc(79,ne,3,0,"div",24),f.ac(),f.ac(),f.Wb(80,"hr"),f.bc(81,"legend"),f.Mc(82,"Items \xf3rden de trabajo"),f.ac(),f.bc(83,"button",26),f.ic("click",(function(){return t.openPopUp("container__addItems"),t.goToUp()})),f.Wb(84,"i",27),f.ac(),f.bc(85,"div",28),f.bc(86,"app-tbl-check-items-for-routine",29),f.ic("onItemsWereSelected",(function(e){return t.setItemsToRoutine(e)}))("onRoutineWasCalculated",(function(e){return t.setTotalRoutine(e)})),f.ac(),f.ac(),f.bc(87,"legend"),f.Mc(88,"Observaciones"),f.ac(),f.bc(89,"div"),f.Wb(90,"textarea",30),f.ac(),f.bc(91,"div",31),f.bc(92,"button",32),f.ic("click",(function(){return t.closeWorkOrder()})),f.Mc(93," Cancelar "),f.ac(),f.bc(94,"button",33),f.ic("click",(function(){return t.saveWorkOrder()})),f.Mc(95," Guardar "),f.ac(),f.ac(),f.bc(96,"div"),f.Lc(97,ie,3,0,"div",34),f.ac(),f.ac(),f.ac(),f.ac(),f.bc(98,"div",35),f.bc(99,"div",36),f.bc(100,"div",37),f.bc(101,"div",38),f.bc(102,"h2"),f.Mc(103,"A\xf1adir item a la orden de trabajo"),f.ac(),f.bc(104,"div",3),f.bc(105,"a"),f.bc(106,"i",39),f.ic("click",(function(){return t.closePopUp("container__addItems")})),f.ac(),f.ac(),f.ac(),f.ac(),f.bc(107,"div",40),f.bc(108,"app-tbl-items-to-add",41),f.ic("newItemsWasSetted",(function(e){return t.addNewMaintenanceItemsToRoutine(e)}))("addItemsWasCanceled",(function(){return t.closePopUp("container__addItems")})),f.ac(),f.ac(),f.ac(),f.ac(),f.ac(),f.Lc(109,ce,1,2,"app-alert-error",42),f.Lc(110,ae,1,0,"app-img-loading",43)),2&e&&(f.Jb(1),f.uc("formGroup",t.frmWorkOrder),f.Jb(14),f.uc("vehicleSelected",t.vehicleSelected),f.Jb(60),f.uc("dealer",t.dealer)("branchSelected",t.branchSelected),f.Jb(1),f.uc("ngIf",t.fieldBranchIsInvalid),f.Jb(2),f.uc("areRoutineFiltered",!0)("vehicleModel",t.vehicleModelSelected),f.Jb(1),f.uc("ngIf",t.fieldMaintenanceRoutineIsInvalid),f.Jb(7),f.uc("maintenanceItems",t.lsMaintenanceItems)("maintenanceItemsSelected",t.lsMaintenanceItemsSelected)("contract",t.contractSelected),f.Jb(8),f.uc("disabled",t.fieldBranchIsInvalid||t.fieldMaintenanceRoutineIsInvalid||t.frmWorkOrder.invalid),f.Jb(3),f.uc("ngIf",t.fieldBranchIsInvalid||t.fieldMaintenanceRoutineIsInvalid||t.frmWorkOrder.invalid),f.Jb(11),f.uc("lsMaintenanceItems",null!=t.pricesByContract?t.pricesByContract.lsMaintenanceItems:f.wc(16,re)),f.Jb(1),f.uc("ngIf",t.isErrorVisible),f.Jb(1),f.uc("ngIf",t.isAwaiting))},directives:[c.B,c.r,c.k,J,c.v,c.c,c.q,c.i,j,i.o,$,z.a,Z,X.a,ee.a],styles:['.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr;justify-content:space-between}.container__col[_ngcontent-%COMP%]{padding:10px}label[_ngcontent-%COMP%]{cursor:pointer}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin-bottom:20px}.container__buttonClose[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px;position:relative;float:right}.container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;padding-top:20px}.error[_ngcontent-%COMP%]{color:red;margin-top:10px}.container__infoError[_ngcontent-%COMP%]:before{position:absolute;content:"";display:block;width:0;height:0;left:50%;margin-left:-10px;margin-top:-30px;border:10px solid transparent;border-bottom-color:#ebd4d4}.container__infoError[_ngcontent-%COMP%]{background-color:#ebd4d4;cursor:pointer;position:absolute;padding:10px 15px;z-index:50;width:200px;height:auto;border-radius:20px;right:3%;margin-top:30px;box-shadow:10px 10px 17px -7px rgba(0,0,0,.75)}.bold[_ngcontent-%COMP%]{font-weight:700}.last-row[_ngcontent-%COMP%]{border-top:2px solid #000;border-bottom:1px solid #000}#container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}#container__addItems[_ngcontent-%COMP%]{display:none}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%}',"select[_ngcontent-%COMP%]{cursor:pointer}.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}.btn-add[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{cursor:pointer}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;position:relative;left:93%;margin-bottom:20px;top:30px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px;margin-left:250px}.container__row_buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;justify-content:right;margin-top:30px}.container__row_buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin-bottom:20px}@media only screen and (max-width:600px){.col-mobile-hide[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{left:80vw}}"]}),e})();var se=n("3+Ze"),le=n("wAkH"),de=n("ZyAM");function ue(e,t){if(1&e&&(f.bc(0,"option",10),f.Mc(1),f.nc(2,"titlecase"),f.ac()),2&e){const e=t.$implicit;f.uc("value",e.id),f.Jb(1),f.Oc(" ",f.oc(2,2,e.name)," ")}}function he(e,t){if(1&e){const e=f.cc();f.bc(0,"div",4),f.bc(1,"app-input-search-dealer",40),f.ic("dealerWasSetted",(function(){return f.Dc(e),f.mc().setDealerToFilter()})),f.ac(),f.ac()}if(2&e){const e=f.mc();f.Jb(1),f.uc("countChanges",e.countChanges)}}function pe(e,t){if(1&e){const e=f.cc();f.bc(0,"div",4),f.bc(1,"app-input-search-client",41),f.ic("clientWasSetted",(function(){return f.Dc(e),f.mc().setClientToFilter()})),f.ac(),f.ac()}if(2&e){const e=f.mc();f.Jb(1),f.uc("countChanges",e.countChanges)}}function be(e,t){if(1&e){const e=f.cc();f.bc(0,"button",42),f.ic("click",(function(){return f.Dc(e),f.mc().toggleBtnFilter()})),f.Mc(1," Filtrar "),f.ac()}}function me(e,t){if(1&e){const e=f.cc();f.bc(0,"button",43),f.ic("click",(function(){return f.Dc(e),f.mc().toggleBtnFilter()})),f.Mc(1," \xd7 Quitar filtros "),f.ac()}}function ge(e,t){if(1&e){const e=f.cc();f.bc(0,"button",44),f.ic("click",(function(){return f.Dc(e),f.mc().openWorkOrder()})),f.Wb(1,"i",45),f.ac()}}function fe(e,t){if(1&e){const e=f.cc();f.bc(0,"div"),f.bc(1,"i",50),f.ic("click",(function(){f.Dc(e);const t=f.mc(2).$implicit,n=f.mc();return n.setTransaction(t),n.openPopUp("container__FinalizeWorkOrder")})),f.ac(),f.bc(2,"i",51),f.ic("click",(function(){f.Dc(e);const t=f.mc(2).$implicit,n=f.mc();return n.setTransaction(t),n.openPopUp("container__Cancelation")})),f.ac(),f.ac()}}function _e(e,t){1&e&&(f.bc(0,"div"),f.Lc(1,fe,3,0,"div",49),f.ac()),2&e&&(f.Jb(1),f.uc("ngSwitchCase",1))}function ve(e,t){if(1&e){const e=f.cc();f.bc(0,"div"),f.bc(1,"i",51),f.ic("click",(function(){f.Dc(e);const t=f.mc(2).$implicit,n=f.mc();return n.setTransaction(t),n.openPopUp("container__Cancelation")})),f.ac(),f.ac()}}function Me(e,t){1&e&&(f.bc(0,"div"),f.Lc(1,ve,2,0,"div",49),f.ac()),2&e&&(f.Jb(1),f.uc("ngSwitchCase",2))}function Ce(e,t){if(1&e){const e=f.cc();f.bc(0,"div"),f.bc(1,"i",52),f.ic("click",(function(){f.Dc(e);const t=f.mc(2).$implicit,n=f.mc();return n.setTransaction(t),n.openPopUp("container__Cancelation")})),f.ac(),f.ac()}}function xe(e,t){1&e&&(f.bc(0,"div"),f.Lc(1,Ce,2,0,"div",49),f.ac()),2&e&&(f.Jb(1),f.uc("ngSwitchCase",3))}function ye(e,t){if(1&e){const e=f.cc();f.bc(0,"tr"),f.bc(1,"td"),f.Mc(2),f.ac(),f.bc(3,"td"),f.Mc(4),f.ac(),f.bc(5,"td"),f.Mc(6),f.ac(),f.bc(7,"td"),f.Mc(8),f.ac(),f.bc(9,"td"),f.Mc(10),f.ac(),f.bc(11,"td"),f.Mc(12),f.nc(13,"uppercase"),f.ac(),f.bc(14,"td"),f.Mc(15),f.nc(16,"date"),f.nc(17,"date"),f.ac(),f.bc(18,"td"),f.Mc(19),f.nc(20,"currency"),f.ac(),f.bc(21,"td"),f.bc(22,"span",46),f.Mc(23),f.ac(),f.ac(),f.bc(24,"td"),f.bc(25,"i",47),f.ic("click",(function(){f.Dc(e);const n=t.$implicit,i=f.mc();return i.setTransaction(n),i.openPopUp("container__resume_main")})),f.ac(),f.bc(26,"div",48),f.Lc(27,_e,2,1,"div",39),f.Lc(28,Me,2,1,"div",39),f.Lc(29,xe,2,1,"div",39),f.ac(),f.ac(),f.ac()}if(2&e){const e=t.$implicit,n=t.index,i=f.mc();f.Jb(2),f.Nc(n+1),f.Jb(2),f.Nc(null!=e.code?e.code:""),f.Jb(2),f.Nc(e.headerDetails.vehicle.licensePlate),f.Jb(2),f.Nc(e.client.name),f.Jb(2),f.Nc(e.headerDetails.maintenanceRoutine.name),f.Jb(2),f.Nc(f.oc(13,14,e.headerDetails.branch.name)),f.Jb(3),f.Oc(" ",null!=e.updateDate?f.pc(16,16,e.updateDate,"yyyy/MM/dd"):f.pc(17,19,e.registrationDate,"yyyy/MM/dd")," "),f.Jb(4),f.Nc(f.rc(20,22,e.value,"USD","symbol","1.0-0")),f.Jb(3),f.uc("id",i.getSpanStateId(e.id)),f.Jb(1),f.Nc(i.validateState(e.transactionState,e.id)),f.Jb(3),f.uc("ngSwitch",i.validateContainerControls(e)),f.Jb(1),f.uc("ngIf",i.isDealer),f.Jb(1),f.uc("ngIf",i.isDealer),f.Jb(1),f.uc("ngIf",i.isDealer)}}function Se(e,t){1&e&&f.Wb(0,"app-img-loading")}const we=function(){return{dateInputFormat:"YYYY/MM/DD",containerClass:"theme-dark-blue"}},Ie=[{path:"",component:o.a,children:[{path:"",component:(()=>{class e{constructor(e,t,n,i,a,r,o){this.transactionService=e,this.notificationService=t,this.datePipe=n,this.dealerService=i,this.clientService=a,this.movementService=r,this.currency=o,this.transactionSelected=new s.a,this.trx_id=0,this.isDealer=!1,this.isMainCompany=!1,this.isFiltered=!1,this.countChanges=0,this.frm_filter=new c.j({txtCode:new c.g(""),txtLicense_plate:new c.g(""),txtInit_date:new c.g(""),txtEnd_date:new c.g(""),cmbState:new c.g("")}),this.frmApprovedTrx=new c.j({txtObservationApprobation:new c.g("")}),this.frmCancelTrx=new c.j({txtObservationCancelation:new c.g("")})}ngOnInit(){this.initComponents()}async initComponents(){this.dealerService.setDealerSelected(null),this.clientService.setClientSelected(null),this.countChanges+=1,this.isAwaiting=!1,this.getCompany(),this.lsTransactionStates=await this.transactionService.getTransactionStates(),this.getMovementList(),await this.initDataToGetReport(),await this.getDataTransactions()}async getMovementList(){try{this.movementService.getMovements().then(e=>{this.lsMovements=e})}catch(e){console.warn(e)}}getCompany(){this.company=l.a.validateUserAndCompany()}async initDataToGetReport(){switch(console.warn("[initDataToGetReport]",this.company),console.log(this.company),this.company.type){case d.a.CLIENT:this.typeOfReport="dealer",this.isMainCompanyLogged=!1,this.client_to_filter=this.company.id,this.dealer_to_filter=null,this.isDealer=!1;break;case d.a.DEALER:this.typeOfReport="client",this.isMainCompanyLogged=!1,this.dealer_to_filter=this.company.id,this.client_to_filter=null,this.isDealer=!0;break;case d.a.MAIN_COMPANY:this.typeOfReport="client",this.isMainCompanyLogged=!0,this.client_to_filter=null,this.dealer_to_filter=null,this.isDealer=!0,this.isMainCompany=!0}}async getDataTransactions(){try{this.isAwaiting=!0,this.transactionService.getTransactionsByDealerOrClient(this.dealer_to_filter,this.client_to_filter,this.init_date,this.end_date,this.code_to_filter,this.license_plate_toFilter,this.state_to_filter).subscribe(e=>{this.lsWorkOrderByDealer=e.filter(e=>3!=e.transactionState.id)}),this.isAwaiting=!1}catch(e){console.warn(e)}}validateState(e,t){const n="#"+this.getSpanStateId(t),i=document.querySelector(n);if(null!=e)switch(e.name.toUpperCase()){case"APROBADA":i.classList.add("tag-active");break;case"FINALIZADA":i.classList.add("tag-ending");break;case"RECHAZADA":i.classList.add("tag-error");break;case"ANULADA":i.classList.add("tag-canceled");break;default:i.classList.add("tag-pending")}else i.classList.add("tag-pending");return null!=e?e.name:"PENDIENTE"}getSpanStateId(e){return"stateTrx_"+e}openWorkOrder(){const e=document.querySelector("#container__table_workOrder"),t=document.querySelector("#container__workOrder");e.setAttribute("style","display:none"),t.setAttribute("style","display:block")}closeWorkOrder(){const e=document.querySelector("#container__table_workOrder"),t=document.querySelector("#container__workOrder");e.setAttribute("style","display:block"),t.setAttribute("style","display:none")}getListWorkOrders(){this.getDataTransactions(),this.closeWorkOrder()}closePopUp(e){document.getElementById(e).style.display="none"}openPopUp(e){document.getElementById(e).style.display="block"}setTransaction(e){this.transactionSelected=e,this.trx_id=e.id}async toggleBtnFilter(){this.isAwaiting=!0,this.isFiltered&&(this.frm_filter.reset(),this.dealerService.setDealerSelected(null),this.clientService.setClientSelected(null),this.countChanges+=1,this.initDataToGetReport()),this.isFiltered=!this.isFiltered,await this.setDataToFilters(),this.isAwaiting=!1}async setDataToFilters(){const{txtCode:e,txtLicense_plate:t,txtInit_date:n,txtEnd_date:i,cmbState:c}=this.frm_filter.controls;this.code_to_filter=e.value,this.license_plate_toFilter=t.value,this.init_date=this.datePipe.transform(n.value,"yyyy/MM/dd"),this.end_date=this.datePipe.transform(i.value,"yyyy/MM/dd"),this.state_to_filter=c.value,this.getDataTransactions()}setDealerToFilter(){const e=this.dealerService.getDealerSelected();this.dealer_to_filter=null!=e?e.id:null}setClientToFilter(){const e=this.clientService.getClientSelected();this.client_to_filter=null!=e?e.id:null}async sendEmail(e){const t=e.client.id,n=e.headerDetails.relatedTransaction.code,{contacts:i}=await this.clientService.getClientById(t),c={nameMessage:"Fleet Service",emailReceiver:i.filter(e=>1==e.mustNotify).map(e=>e.email),typemessage:e.movement.id,nOrderwork:n};c.emailReceiver.length>0&&this.notificationService.sendMail(c).subscribe(e=>{console.log(e)})}async finalizeWorkOrder(){try{this.isAwaiting=!0;const e=this.lsMovements.find(e=>e.id==u.b.FINALIZACION_ORDEN_DE_TRABAJO),{txtObservationApprobation:t}=this.frmApprovedTrx.controls,n=this.setDataTransaction(this.transactionSelected,e,t.value);this.sendEmail(n),this.transactionService.processTransaction(n).subscribe(e=>{e.response&&(this.sendEmail(n),m.a.fire({position:"center",icon:"success",title:e.message,showConfirmButton:!0}),this.getDataTransactions(),this.closePopUp("container__FinalizeWorkOrder"))}),this.isAwaiting=!1}catch(e){console.warn(e)}}async cancelWorkOrder(){try{this.isAwaiting=!0;const e=this.lsMovements.find(e=>e.id==u.b.ANULACION_ORDEN_DE_TRABAJO),{txtObservationCancelation:t}=this.frmCancelTrx.controls,n=this.setDataTransaction(this.transactionSelected,e,t.value);this.transactionService.processTransaction(n).subscribe(e=>{e.response&&(m.a.fire({position:"center",icon:"success",title:e.message,showConfirmButton:!0}),this.getDataTransactions(),this.closePopUp("container__Cancelation"))}),this.isAwaiting=!1}catch(e){console.warn(e)}}setDataTransaction(e,t,n){const i=new s.a;i.movement=t,i.value=e.value,i.usu_id=l.a.validateUserLogged(),i.client=e.client,i.headerDetails=new h.a,i.headerDetails.relatedTransaction=e;const c=new p.a;c.usu_id=l.a.validateUserLogged(),c.description=n;const a=[];return""!=n&&a.push(c),i.lsObservations=a,i}clearForms(){this.frmApprovedTrx.reset(),this.frmCancelTrx.reset()}validateContainerControls(e){let t=0;return"APROBADA"==e.transactionState.name.toUpperCase()&&(t=1),"PENDIENTE"==e.transactionState.name.toUpperCase()&&(t=2),"RECHAZADA"==e.transactionState.name.toUpperCase()&&(t=3),t}downloadExcel(){const e=this.lsWorkOrderByDealer.map(e=>({Codigo:e.code,Placa:e.headerDetails.vehicle.licensePlate,Cliente:e.client.name,Mantenimiento:e.headerDetails.maintenanceRoutine.name,Sucursal:e.headerDetails.branch.name,Fecha:new Date(e.registrationDate).toLocaleDateString(),Valor:this.currency.transform(e.value),Estado:e.transactionState.name}));g.a.convertArrayToFile(e,"Ordenes de trabajo")}}return e.\u0275fac=function(t){return new(t||e)(f.Vb(_.a),f.Vb(v.a),f.Vb(i.f),f.Vb(M.a),f.Vb(C.a),f.Vb(x.a),f.Vb(i.d))},e.\u0275cmp=f.Pb({type:e,selectors:[["app-work-order-manager"]],decls:120,vars:24,consts:[["id","container__content"],["id","container__table_workOrder"],[3,"formGroup"],[1,"container__filter"],[1,"container__col"],["type","text","formControlName","txtCode",1,"form-control"],["type","text","formControlName","txtLicense_plate",1,"form-control"],["type","text","placeholder","fecha inicio ...","bsDatepicker","","formControlName","txtInit_date",1,"form-control",3,"bsValue","bsConfig"],["type","text","placeholder","fecha fin ...","bsDatepicker","","formControlName","txtEnd_date",1,"form-control",3,"bsValue","bsConfig"],["formControlName","cmbState",1,"form-control"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","container__col",4,"ngIf"],[1,"container__buttons"],["class","btn btn-info",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"text-right"],[1,"btn","btn-primary",3,"click"],["class","btn-add btn-info",3,"click",4,"ngIf"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],["id","container__workOrder"],[3,"workOrderWasSaved","workOrderWasCanceled"],["id","container__resume_main"],[1,"overlay"],[1,"card","card-review"],[1,"card-header","container__header"],[1,"container__buttonClose"],[1,"fas","fa-times",3,"click"],[1,"card-body"],[3,"trx_id"],["id","container__FinalizeWorkOrder"],[1,"card-footer"],["formControlName","txtObservationApprobation","cols","30","rows","2",1,"form-control"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["id","container__Cancelation"],["formControlName","txtObservationCancelation","cols","30","rows","2",1,"form-control"],[4,"ngIf"],[3,"countChanges","dealerWasSetted"],[3,"countChanges","clientWasSetted"],[1,"btn","btn-info",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"btn-add","btn-info",3,"click"],[1,"fas","fa-plus"],[3,"id"],["title","M\xe1s informaci\xf3n",1,"fas","fa-info-circle","text-info",3,"click"],[1,"container__controls",3,"ngSwitch"],[4,"ngSwitchCase"],["title","Finalizar",1,"fas","fa-check-circle","text-success",3,"click"],["title","Anular",1,"fas","fa-times-circle","text-danger",3,"click"],["title","Editar",1,"far","fa-edit",3,"click"]],template:function(e,t){1&e&&(f.bc(0,"div",0),f.bc(1,"div",1),f.bc(2,"h1"),f.Mc(3,"\xd3rdenes de trabajo"),f.ac(),f.bc(4,"form",2),f.bc(5,"div",3),f.bc(6,"div",4),f.bc(7,"label"),f.Mc(8,"C\xf3digo"),f.ac(),f.Wb(9,"input",5),f.ac(),f.bc(10,"div",4),f.bc(11,"label"),f.Mc(12,"Placa"),f.ac(),f.Wb(13,"input",6),f.ac(),f.bc(14,"div",4),f.bc(15,"label"),f.Mc(16,"Fecha inicio:"),f.ac(),f.Wb(17,"input",7),f.ac(),f.bc(18,"div",4),f.bc(19,"label"),f.Mc(20,"Fecha fin:"),f.ac(),f.Wb(21,"input",8),f.ac(),f.bc(22,"div",4),f.bc(23,"label"),f.Mc(24,"Estado"),f.ac(),f.bc(25,"select",9),f.bc(26,"option",10),f.Mc(27,"Seleccione ..."),f.ac(),f.Lc(28,ue,3,4,"option",11),f.ac(),f.ac(),f.Lc(29,he,2,1,"div",12),f.Lc(30,pe,2,1,"div",12),f.bc(31,"div",13),f.Lc(32,be,2,0,"button",14),f.Lc(33,me,2,0,"button",15),f.ac(),f.ac(),f.bc(34,"div",16),f.bc(35,"button",17),f.ic("click",(function(){return t.downloadExcel()})),f.Mc(36," Descargar Excel "),f.ac(),f.ac(),f.ac(),f.Lc(37,ge,2,0,"button",18),f.bc(38,"table",19),f.bc(39,"thead"),f.bc(40,"th"),f.Mc(41,"#"),f.ac(),f.bc(42,"th"),f.Mc(43,"C\xf3digo"),f.ac(),f.bc(44,"th"),f.Mc(45,"Placa"),f.ac(),f.bc(46,"th"),f.Mc(47,"Cliente"),f.ac(),f.bc(48,"th"),f.Mc(49,"Mantenimiento"),f.ac(),f.bc(50,"th"),f.Mc(51,"Sucursal"),f.ac(),f.bc(52,"th"),f.Mc(53,"Fecha"),f.ac(),f.bc(54,"th"),f.Mc(55,"Valor"),f.ac(),f.bc(56,"th"),f.Mc(57,"Estado"),f.ac(),f.bc(58,"th"),f.Mc(59,"Acciones"),f.ac(),f.ac(),f.bc(60,"tbody"),f.Lc(61,ye,30,27,"tr",20),f.ac(),f.ac(),f.ac(),f.bc(62,"div",21),f.bc(63,"app-work-order",22),f.ic("workOrderWasSaved",(function(){return t.getListWorkOrders()}))("workOrderWasCanceled",(function(){return t.closeWorkOrder()})),f.ac(),f.ac(),f.ac(),f.bc(64,"div",23),f.bc(65,"div",24),f.bc(66,"div",25),f.bc(67,"div",26),f.bc(68,"h2"),f.Mc(69),f.ac(),f.bc(70,"div",27),f.bc(71,"a"),f.bc(72,"i",28),f.ic("click",(function(){return t.closePopUp("container__resume_main")})),f.ac(),f.ac(),f.ac(),f.ac(),f.bc(73,"div",29),f.Wb(74,"app-transaction-review",30),f.ac(),f.ac(),f.ac(),f.ac(),f.bc(75,"div",31),f.bc(76,"div",24),f.bc(77,"div",25),f.bc(78,"div",26),f.bc(79,"h2"),f.Mc(80),f.ac(),f.bc(81,"div",27),f.bc(82,"a"),f.bc(83,"i",28),f.ic("click",(function(){return t.closePopUp("container__FinalizeWorkOrder")})),f.ac(),f.ac(),f.ac(),f.ac(),f.bc(84,"div",29),f.Wb(85,"app-transaction-review",30),f.ac(),f.bc(86,"div",32),f.bc(87,"form",2),f.bc(88,"div"),f.bc(89,"legend"),f.Mc(90," Observaciones de la finalizaci\xf3n de la orden de trabajo "),f.ac(),f.bc(91,"textarea",33),f.Mc(92,"            "),f.ac(),f.ac(),f.ac(),f.bc(93,"div",34),f.bc(94,"button",35),f.ic("click",(function(){return t.closePopUp("container__FinalizeWorkOrder"),t.clearForms()})),f.Mc(95," Cancelar "),f.ac(),f.bc(96,"button",36),f.ic("click",(function(){return t.finalizeWorkOrder()})),f.Mc(97," Guardar "),f.ac(),f.ac(),f.ac(),f.ac(),f.ac(),f.ac(),f.bc(98,"div",37),f.bc(99,"div",24),f.bc(100,"div",25),f.bc(101,"div",26),f.bc(102,"h2"),f.Mc(103),f.ac(),f.bc(104,"div",27),f.bc(105,"a"),f.bc(106,"i",28),f.ic("click",(function(){return t.closePopUp("container__Cancelation")})),f.ac(),f.ac(),f.ac(),f.ac(),f.bc(107,"div",29),f.Wb(108,"app-transaction-review",30),f.ac(),f.bc(109,"div",32),f.bc(110,"form",2),f.bc(111,"legend"),f.Mc(112,"Observaciones de la anulaci\xf3n"),f.ac(),f.Wb(113,"textarea",38),f.bc(114,"div",34),f.bc(115,"button",35),f.ic("click",(function(){return t.closePopUp("container__Cancelation"),t.clearForms()})),f.Mc(116," Cancelar "),f.ac(),f.bc(117,"button",36),f.ic("click",(function(){return t.cancelWorkOrder()})),f.Mc(118," Guardar "),f.ac(),f.ac(),f.ac(),f.ac(),f.ac(),f.ac(),f.ac(),f.Lc(119,Se,1,0,"app-img-loading",39)),2&e&&(f.Jb(4),f.uc("formGroup",t.frm_filter),f.Jb(13),f.uc("bsValue",t.init_date)("bsConfig",f.wc(22,we)),f.Jb(4),f.uc("bsValue",t.end_date)("bsConfig",f.wc(23,we)),f.Jb(5),f.uc("value",-1),f.Jb(2),f.uc("ngForOf",t.lsTransactionStates),f.Jb(1),f.uc("ngIf",!t.isDealer||t.isMainCompany),f.Jb(1),f.uc("ngIf",t.isDealer),f.Jb(2),f.uc("ngIf",!t.isFiltered),f.Jb(1),f.uc("ngIf",t.isFiltered),f.Jb(4),f.uc("ngIf",t.isDealer),f.Jb(24),f.uc("ngForOf",t.lsWorkOrderByDealer),f.Jb(8),f.Oc(" Resumen orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),f.Jb(5),f.uc("trx_id",t.trx_id),f.Jb(6),f.Oc(" Finalizar orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),f.Jb(5),f.uc("trx_id",t.trx_id),f.Jb(2),f.uc("formGroup",t.frmApprovedTrx),f.Jb(16),f.Oc(" Anular orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),f.Jb(5),f.uc("trx_id",t.trx_id),f.Jb(2),f.uc("formGroup",t.frmCancelTrx),f.Jb(9),f.uc("ngIf",t.isAwaiting))},directives:[c.B,c.r,c.k,c.c,c.q,c.i,y.b,y.a,c.x,c.u,c.A,i.n,i.o,oe,se.a,le.a,de.a,i.q,i.r,ee.a],pipes:[i.x,i.y,i.f,i.d],styles:["#container__workOrder[_ngcontent-%COMP%]{display:none}.tag-error[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:#ea2c62;padding:8px 20px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}.tag-active[_ngcontent-%COMP%]{background-color:#ade498}.tag-active[_ngcontent-%COMP%], .tag-ending[_ngcontent-%COMP%]{display:flex;flex-direction:row;padding:8px 40px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}.tag-ending[_ngcontent-%COMP%]{background-color:#469627}.tag-canceled[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:#7e0c2c;padding:8px 40px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}.container__controls[_ngcontent-%COMP%]{display:inline-block}.tag-pending[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:#f0e050;padding:8px 40px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px;margin-left:250px}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}.btn-add[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{cursor:pointer}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;position:relative;left:93%;margin-bottom:20px;top:10px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%;overflow:scroll;overflow-x:hidden}#container__resume_main[_ngcontent-%COMP%]{display:none}.container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.container__buttonClose[_ngcontent-%COMP%]{margin-top:10px}.card-review[_ngcontent-%COMP%]{width:1200px;height:auto}.container__filter[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;margin-bottom:10px}.container__filter[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:10px 20px;width:250px}.container__buttons[_ngcontent-%COMP%]{justify-content:center;align-items:center}.container__buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:125px;height:auto;margin-left:10px;margin-top:30px}#container__Cancelation[_ngcontent-%COMP%], #container__FinalizeWorkOrder[_ngcontent-%COMP%]{display:none}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}"]}),e})()}]}];let Oe=(()=>{class e{}return e.\u0275mod=f.Tb({type:e}),e.\u0275inj=f.Sb({factory:function(t){return new(t||e)},imports:[[r.f.forChild(Ie)],r.f]}),e})(),ke=(()=>{class e{}return e.\u0275mod=f.Tb({type:e}),e.\u0275inj=f.Sb({factory:function(t){return new(t||e)},imports:[[i.c,c.l,c.w,a.a,Oe,y.c.forRoot()]]}),e})()},"U+sL":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("tk/3"),c=n("fXoL");let a=(()=>{class e{constructor(e){this.http=e,this.URL_API="/API_FleetService/api/Branch/",this.HttpOptions={headers:new i.c({"Content-Type":"application/json"})}}getBranchs(e,t){return this.http.get(`${this.URL_API}/Get?pOwner_id=${e}&pKindOfOwner=${t}`)}insert(e){return this.http.post(this.URL_API+"/Insert",e,this.HttpOptions)}update(e){return this.http.post(this.URL_API+"/Update",e,this.HttpOptions)}delete(e){return this.http.post(this.URL_API+"/Delete",e,this.HttpOptions)}setBranchSelected(e){this.branchSelected=e}getBranchSelected(){return this.branchSelected}}return e.\u0275fac=function(t){return new(t||e)(c.fc(i.a))},e.\u0275prov=c.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},i5Qh:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("tk/3"),c=n("LRne"),a=n("JIr8"),r=n("AytR"),o=n("fXoL");let s=(()=>{class e{constructor(e){this.http=e,this.URL_API=r.a.apiUrl+"/Client",this.HttpOptions={headers:new i.c({"Content-Type":"application/json"})}}getClients(){return this.http.get(this.URL_API+"/Get")}async getClientById(e){return this.http.get(`${this.URL_API}/GetById?pId=${e}`).toPromise()}async getClientByDocument(e){return this.http.get(`${this.URL_API}/GetByDocument?pDocument=${e}`).toPromise()}getClientsByDescriptions(e){return e.trim()?this.http.get(`${this.URL_API}/GetByDescription?sDescription=${e}`).pipe(Object(a.a)(this.handleError("getClientsByDescriptions",[]))):Object(c.a)([])}insertClient(e){return this.http.post(this.URL_API+"/Insert",e,this.HttpOptions)}updateClient(e){return this.http.post(this.URL_API+"/Update",e,this.HttpOptions)}async deleteClient(e){return this.http.post(this.URL_API+"/Delete",e,this.HttpOptions).toPromise()}setClientToUpdate(e){this.clientToUpdate=e}getClientToUpdate(){return this.clientToUpdate}setClientSelected(e){this.clientSelected=e}getClientSelected(){return this.clientSelected}getBlockFormClient(){return this.blockFormClient}setBlockFormClient(e){this.blockFormClient=e}getAction(){return this.action}setAction(e){this.action=e}handleError(e="operation",t){return e=>(console.error(e),Object(c.a)(t))}}return e.\u0275fac=function(t){return new(t||e)(o.fc(i.a))},e.\u0275prov=o.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);