!function(){function e(e,t,n,i,c,r,a){try{var o=e[r](a),s=o.value}catch(l){return void n(l)}o.done?t(s):Promise.resolve(s).then(i,c)}function t(t){return function(){var n=this,i=arguments;return new Promise((function(c,r){var a=t.apply(n,i);function o(t){e(a,c,r,o,s,"next",t)}function s(t){e(a,c,r,o,s,"throw",t)}o(void 0)}))}}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"7I7t":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("930R"),a=function e(){c(this,e)},o=function(){function e(){c(this,e)}return i(e,null,[{key:"validateUserAndCompany",value:function(){try{var e=new a,t=JSON.parse(sessionStorage.getItem("sessionUser"));return console.log(t),e.type=t.company.type,e.id=t.company.type==r.a.DEALER||t.company.type==r.a.CLIENT?t.company.id:0,e.usr_id=t.id_user,e}catch(n){console.warn(n)}}},{key:"validateUserLogged",value:function(){try{return JSON.parse(sessionStorage.getItem("sessionUser")).id_user}catch(e){console.warn(e)}}}]),e}()},"9w/y":function(e,n,r){"use strict";r.d(n,"a",(function(){return l}));var a=r("tk/3"),o=r("AytR"),s=r("fXoL"),l=function(){var e=function(){function e(t){c(this,e),this.http=t,this.URL_API=o.a.apiUrl+"/FinancialInformation",this.HttpOptions={headers:new a.c({"Content-Type":"application/json"})}}var n,r;return i(e,[{key:"getClientsWithQuota",value:(r=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.get(this.URL_API+"/GetClientsWithQuota").toPromise());case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getClientsWithoutQuota",value:function(){return this.http.get(this.URL_API+"/GetClientsWithoutQuota")}},{key:"getFinancialInformationByClient",value:function(e){return this.http.get("".concat(this.URL_API,"/GetFinancialInformationByClient?client_id=").concat(e))}},{key:"validatePaymentVsConsumedQuota",value:(n=t(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.get("".concat(this.URL_API,"/ValidatePaymentVsConsumedQuota?pClient_id=").concat(t,"&paymentValue=").concat(n)).toPromise());case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.fc(a.a))},e.\u0275prov=s.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},TO7w:function(e,n,r){"use strict";r.r(n),r.d(n,"WorkOrderManagerModule",(function(){return Ee}));var a=r("ofXK"),o=r("3Pt+"),s=r("Z/wE"),l=r("tyNb"),u=r("uswQ"),d=r("KBdt"),h=r("7I7t"),p=r("930R"),f=r("jvTp"),b=r("K9Qb"),m=r("KyVN"),g=r("PSD3"),v=r.n(g),_=r("QgiH"),y=r("fXoL"),M=r("a9jy"),x=r("JP3n"),C=r("FMJ1"),k=r("i5Qh"),w=r("aouF"),S=r("hzby"),I=r("us/p"),O=r("R7St"),P=function e(){c(this,e)},R=r("0x5P"),W=r("2jix"),T=r("U+sL"),D=r("Dhb6"),A=r("xch/"),F=r("9w/y"),B=r("vllv"),L=r("3LUQ"),V=r("XNiG"),E=r("Kj3r"),N=r("/uUt"),J=r("eIep");function U(e,t){if(1&e){var n=y.cc();y.bc(0,"li",4),y.ic("click",(function(){y.Dc(n);var e=t.$implicit;return y.mc(2).setVehicle(e)})),y.bc(1,"span",5),y.Mc(2),y.nc(3,"uppercase"),y.ac(),y.bc(4,"span",6),y.Mc(5),y.nc(6,"titlecase"),y.ac(),y.ac()}if(2&e){var i=t.$implicit;y.Jb(2),y.Nc(y.oc(3,2,i.licensePlate)),y.Jb(3),y.Oc("| ",y.oc(6,4,i.vehicleModel.shortName),"")}}function j(e,t){if(1&e&&(y.bc(0,"ul"),y.Lc(1,U,7,6,"li",3),y.nc(2,"async"),y.ac()),2&e){var n=y.mc();y.Jb(1),y.uc("ngForOf",y.oc(2,1,n.lsVehicleSuggestion$))}}var q,z=((q=function(){function e(t){c(this,e),this.vehicleService=t,this.description=new V.a,this.vehicleWasSetted=new y.q,this.frmSearchVehicle=new o.j({txtLicensePlate:new o.g("")})}var n;return i(e,[{key:"ngOnChanges",value:function(e){for(var t in e)"vehicleSelected"==t&&null==this.vehicleSelected&&this.frmSearchVehicle.reset()}},{key:"ngOnInit",value:function(){this.initComponents()}},{key:"initComponents",value:(n=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.listIsvisible=!1,this.searchVehicles();case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"searchVehicles",value:function(){var e=this;this.lsVehicleSuggestion$=this.description.pipe(Object(E.a)(300),Object(N.a)(),Object(J.a)((function(t){return e.vehicleService.getVehiclesByLicensePlate(t)})))}},{key:"setVehicle",value:function(e){this.frmSearchVehicle.controls.txtLicensePlate.setValue(e.licensePlate),this.listIsvisible=!1,this.vehicleService.setVehicle(e),this.vehicleWasSetted.emit(!0)}},{key:"searchBydescription",value:function(e){this.listIsvisible=!0,this.description.next(e)}}]),e}()).\u0275fac=function(e){return new(e||q)(y.Vb(R.a))},q.\u0275cmp=y.Pb({type:q,selectors:[["app-input-search-vehicle"]],inputs:{vehicleSelected:"vehicleSelected"},outputs:{vehicleWasSetted:"vehicleWasSetted"},features:[y.Hb],decls:5,vars:2,consts:[[3,"formGroup"],["type","text","formControlName","txtLicensePlate","placeholder","Placa ...",1,"form-control",3,"input"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"container__licensePlate"],[1,"container__vehicleModel"]],template:function(e,t){1&e&&(y.bc(0,"form",0),y.bc(1,"label"),y.Mc(2,"Placa:"),y.ac(),y.bc(3,"input",1),y.ic("input",(function(e){return t.searchBydescription(e.target.value)})),y.ac(),y.Lc(4,j,3,3,"ul",2),y.ac()),2&e&&(y.uc("formGroup",t.frmSearchVehicle),y.Jb(4),y.uc("ngIf",t.listIsvisible))},directives:[o.B,o.r,o.k,o.c,o.q,o.i,a.o,a.n],pipes:[a.b,a.y,a.x],styles:["","ul[_ngcontent-%COMP%]{position:absolute;z-index:3}li[_ngcontent-%COMP%]{list-style:none;padding:5px;border-bottom:1px solid grey;cursor:pointer;width:450px;background-color:#fff}li[_ngcontent-%COMP%]:hover{background-color:#87cefa;color:#fff}.container__document[_ngcontent-%COMP%]{display:inline-block;width:100px;height:auto}"]}),q);function G(e,t){if(1&e&&(y.bc(0,"option",2),y.Mc(1),y.nc(2,"uppercase"),y.ac()),2&e){var n=t.$implicit;y.uc("value",n.id),y.Jb(1),y.Nc(y.oc(2,2,n.name))}}var Q,H=((Q=function(){function e(t){c(this,e),this.branchService=t,this.branchWasSetted=new y.q,this.frmBranch=new o.j({cmbBranch:new o.g("")})}var n;return i(e,[{key:"ngOnChanges",value:function(e){var t;for(var n in e)"dealer"==n&&this.getListBranchByDealer(null===(t=this.dealer)||void 0===t?void 0:t.id)}},{key:"ngOnInit",value:function(){this.initComponents()}},{key:"initComponents",value:function(){var e;this.getListBranchByDealer(null===(e=this.dealer)||void 0===e?void 0:e.id)}},{key:"getListBranchByDealer",value:(n=t(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.branchService.getBranchs(t,"DEALER").subscribe((function(e){n.lsBranch=e}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setBranch",value:function(e){var t=this.lsBranch.find((function(t){return t.id==e.value}));this.branchService.setBranchSelected(t),this.branchWasSetted.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||Q)(y.Vb(T.a))},Q.\u0275cmp=y.Pb({type:Q,selectors:[["app-branch-by-dealer"]],inputs:{branchSelected:"branchSelected",dealer:"dealer"},outputs:{branchWasSetted:"branchWasSetted"},features:[y.Hb],decls:7,vars:3,consts:[[3,"formGroup"],["formControlName","cmbBranch",1,"browser-default","custom-select",3,"change"],[3,"value"],[3,"value",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(y.bc(0,"form",0),y.bc(1,"label"),y.Mc(2,"Sucursal"),y.ac(),y.bc(3,"select",1),y.ic("change",(function(e){return t.setBranch(e.target)})),y.bc(4,"option",2),y.Mc(5,"Seleccione ..."),y.ac(),y.Lc(6,G,3,4,"option",3),y.ac(),y.ac()),2&e&&(y.uc("formGroup",t.frmBranch),y.Jb(4),y.uc("value",0),y.Jb(2),y.uc("ngForOf",t.lsBranch))},directives:[o.B,o.r,o.k,o.x,o.q,o.i,o.u,o.A,a.n],pipes:[a.y],styles:["select[_ngcontent-%COMP%]{cursor:pointer}"]}),Q);function $(e,t){if(1&e&&(y.bc(0,"option",2),y.Mc(1),y.nc(2,"uppercase"),y.ac()),2&e){var n=t.$implicit;y.uc("value",n.id),y.Jb(1),y.Oc(" ",y.oc(2,2,n.name)," ")}}var K,Y=((K=function(){function e(t){c(this,e),this.maintenanceRoutineService=t,this.lsRoutine=[],this.lsRoutinesFiltered=[],this.maintenanceRoutineSelected=[],this.vehicleModel=null,this.routineWasSetted=new y.q,this.areRoutineFiltered=!1,this.onRoutineWasChanged=new y.q,this.frmRoutineByVehicleModel=new o.j({cmbRoutineByVehicleModel:new o.g("Seleccione")})}return i(e,[{key:"ngOnChanges",value:function(e){for(var t in e)"vehicleModel"==t&&(null==this.vehicleModel?this.frmRoutineByVehicleModel.controls.cmbRoutineByVehicleModel.setValue(0):this.getListMaintenanceRoutines(this.vehicleModel.id))}},{key:"ngOnInit",value:function(){}},{key:"getListMaintenanceRoutines",value:function(e){var t=this;try{this.maintenanceRoutineService.getMaintenanceRoutineByModel(e).subscribe((function(e){t.lsRoutine=e,t.lsRoutinesFiltered=t.lsRoutine,t.areRoutineFiltered&&(t.lsRoutinesFiltered=t.filterRoutinesWithoutItems(t.lsRoutine))}))}catch(n){console.warn(n)}}},{key:"setRoutine",value:function(e){var t=this.lsRoutine.find((function(t){return t.id==e.value}));this.maintenanceRoutineService.setRoutine(t),this.routineWasSetted.emit(!0),this.onRoutineWasChanged.emit(t)}},{key:"filterRoutinesWithoutItems",value:function(e){var t=[];if(null!=e){t=e.filter((function(e){return null!=e.lsItems&&e.lsItems.length>0})),console.log("filterRoutinesWithoutItems"),console.log(e);var n=e.find((function(e){return 21==e.frequency.id}));null!=n&&t.push(n)}return t}},{key:"setVehicleModel",set:function(e){this.vehicleModel=e,this.vehicleModel&&this.getListMaintenanceRoutines(this.vehicleModel.id)}},{key:"setRoutineFiltered",set:function(e){this.areRoutineFiltered=e,this.areRoutineFiltered&&(this.lsRoutinesFiltered=this.filterRoutinesWithoutItems(this.lsRoutine))}}]),e}()).\u0275fac=function(e){return new(e||K)(y.Vb(D.a))},K.\u0275cmp=y.Pb({type:K,selectors:[["app-routines-by-vehicle-model"]],inputs:{setVehicleModel:["vehicleModel","setVehicleModel"],countChanges:"countChanges",setRoutineFiltered:["areRoutineFiltered","setRoutineFiltered"]},outputs:{routineWasSetted:"routineWasSetted",onRoutineWasChanged:"onRoutineWasChanged"},features:[y.Hb],decls:7,vars:3,consts:[[3,"formGroup"],["formControlName","cmbRoutineByVehicleModel",1,"browser-default","custom-select",3,"change"],[3,"value"],[3,"value",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(y.bc(0,"form",0),y.bc(1,"label"),y.Mc(2,"Rutina de mantenimiento"),y.ac(),y.bc(3,"select",1),y.ic("change",(function(e){return t.setRoutine(e.target)})),y.bc(4,"option",2),y.Mc(5,"Seleccione ..."),y.ac(),y.Lc(6,$,3,4,"option",3),y.ac(),y.ac()),2&e&&(y.uc("formGroup",t.frmRoutineByVehicleModel),y.Jb(4),y.uc("value",0),y.Jb(2),y.uc("ngForOf",t.lsRoutinesFiltered))},directives:[o.B,o.r,o.k,o.x,o.q,o.i,o.u,o.A,a.n],pipes:[a.y],styles:["select[_ngcontent-%COMP%]{cursor:pointer}"]}),K),Z=r("pMMx"),X=r("oOf3");function ee(e,t){if(1&e){var n=y.cc();y.bc(0,"i",15),y.ic("click",(function(){return y.Dc(n),y.mc().clearFilter()})),y.ac()}}function te(e,t){if(1&e){var n=y.cc();y.bc(0,"tr"),y.bc(1,"td"),y.Mc(2),y.ac(),y.bc(3,"td"),y.bc(4,"label",16),y.bc(5,"input",17),y.ic("click",(function(e){y.Dc(n);var i=t.$implicit;return y.mc().pickItemToAdd(e.target,i)})),y.ac(),y.Wb(6,"span",18),y.ac(),y.ac(),y.bc(7,"td"),y.bc(8,"Label",19),y.Mc(9),y.nc(10,"slice"),y.nc(11,"titlecase"),y.ac(),y.ac(),y.bc(12,"td"),y.Mc(13),y.ac(),y.bc(14,"td"),y.Mc(15),y.nc(16,"currency"),y.ac(),y.ac()}if(2&e){var i=t.index,c=t.$implicit,r=y.mc();y.Jb(2),y.Nc(i+1),y.Jb(3),y.uc("id",r.getCheckBoxId(c.id)),y.Jb(3),y.uc("for",r.getCheckBoxId(c.id)),y.Jb(1),y.Oc(" ",y.qc(10,6,y.oc(11,10,c.code+" - "+c.name),0,80)," "),y.Jb(4),y.Nc(c.presentationUnit.shortName),y.Jb(2),y.Nc(y.oc(16,12,c.referencePrice))}}function ne(e,t){if(1&e&&(y.bc(0,"li"),y.Mc(1),y.nc(2,"slice"),y.nc(3,"titlecase"),y.Wb(4,"hr"),y.ac()),2&e){var n=t.$implicit;y.Jb(1),y.Oc("",y.qc(2,1,y.oc(3,5,n.code+" - "+n.name),0,40)," ")}}var ie,ce=function(e){return{itemsPerPage:5,currentPage:e}},re=((ie=function(){function e(){c(this,e),this.newItemsWasSetted=new y.q,this.addItemsWasCanceled=new y.q,this.p=1,this.clearFilterIsVisible=!1,this.lsItemsToAddSelected=[],this.countChanges=0}return i(e,[{key:"ngOnInit",value:function(){this.lsMaintenanceItemsTemp=this.lsMaintenanceItems}},{key:"pickItemToAdd",value:function(e,t){if(e.checked)this.lsItemsToAddSelected.push(t);else{var n=this.lsItemsToAddSelected.find((function(e){return e.id==t.id})),i=this.lsItemsToAddSelected.indexOf(n);this.lsItemsToAddSelected.splice(i,1)}}},{key:"getCheckBoxId",value:function(e){return"chk_add_"+e}},{key:"filterItems",value:function(e){try{this.validateItemsChecked();var t=e.target.value.toString().toLowerCase();""!=t.trim()?(this.clearFilterIsVisible=!0,this.lsMaintenanceItemsTemp=this.lsMaintenanceItems.filter((function(e){return e.code.toLowerCase().includes(t)||e.name.toLowerCase().includes(t)}))):this.clearFilter()}catch(n){console.warn(n)}}},{key:"clearFilter",value:function(){try{this.validateItemsChecked(),this.lsMaintenanceItemsTemp=this.lsMaintenanceItems,document.querySelector("#txtFilter").value="",this.clearFilterIsVisible=!1,this.p=1}catch(e){}}},{key:"validateItemsChecked",value:function(){var e=this;setTimeout((function(){e.lsItemsToAddSelected.forEach((function(t){try{var n="#"+e.getCheckBoxId(t.id);document.querySelector(n).checked=!0}catch(i){}}))}),300)}},{key:"addItemsToWorkOrder",value:function(){this.newItemsWasSetted.emit(this.lsItemsToAddSelected)}},{key:"cancelAddItems",value:function(){confirm("\xbfEst\xe1 seguro que desea cancelar la adici\xf3n de items?, s\xed lo hace perdera todo el avance registrado")&&(this.lsItemsToAddSelected=[],this.addItemsWasCanceled.emit(!0))}},{key:"turnOffCheckBoxes",value:function(){var e=this;this.lsItemsToAddSelected.forEach((function(t){try{var n="#"+e.getCheckBoxId(t.id);document.querySelector(n).checked=!1}catch(i){}}))}},{key:"setLsMaintenanceItems",set:function(e){this.lsMaintenanceItems=e,this.turnOffCheckBoxes(),this.lsItemsToAddSelected=[],this.lsMaintenanceItemsTemp=this.lsMaintenanceItems}}]),e}()).\u0275fac=function(e){return new(e||ie)},ie.\u0275cmp=y.Pb({type:ie,selectors:[["app-tbl-items-to-add"]],inputs:{setLsMaintenanceItems:["lsMaintenanceItems","setLsMaintenanceItems"],countChanges:"countChanges"},outputs:{newItemsWasSetted:"newItemsWasSetted",addItemsWasCanceled:"addItemsWasCanceled"},decls:38,vars:8,consts:[[1,"container__content"],[1,"container__row"],[1,"container___col"],["type","text","id","txtFilter",1,"form-control",3,"input"],["class","fas fa-times clear_filter","title","Borrar filtro",3,"click",4,"ngIf"],["id","container__table_resume"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"paginationContainer"],[3,"pageChange"],["id","container__resume"],[1,"title_resume"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["title","Borrar filtro",1,"fas","fa-times","clear_filter",3,"click"],[1,"container__checkbox"],["type","checkbox",3,"id","click"],[1,"checkmark"],[3,"for"]],template:function(e,t){1&e&&(y.bc(0,"div",0),y.bc(1,"div",1),y.bc(2,"div",2),y.bc(3,"label"),y.Mc(4,"Nombre / C\xf3digo"),y.ac(),y.bc(5,"input",3),y.ic("input",(function(e){return t.filterItems(e)})),y.ac(),y.Lc(6,ee,1,0,"i",4),y.ac(),y.ac(),y.Wb(7,"hr"),y.bc(8,"div",5),y.bc(9,"div"),y.bc(10,"table",6),y.bc(11,"thead"),y.bc(12,"th"),y.Mc(13,"#"),y.ac(),y.bc(14,"th"),y.Mc(15,"-"),y.ac(),y.bc(16,"th"),y.Mc(17,"C\xf3digo / Nombre"),y.ac(),y.bc(18,"th"),y.Mc(19,"Presentaci\xf3n"),y.ac(),y.bc(20,"th"),y.Mc(21,"Valor sin impuestos"),y.ac(),y.ac(),y.bc(22,"tbody"),y.Lc(23,te,17,14,"tr",7),y.nc(24,"paginate"),y.ac(),y.ac(),y.bc(25,"div",8),y.bc(26,"pagination-controls",9),y.ic("pageChange",(function(e){return t.p=e,t.validateItemsChecked()})),y.ac(),y.ac(),y.ac(),y.bc(27,"div",10),y.bc(28,"legend",11),y.Mc(29,"Resumen"),y.ac(),y.bc(30,"ol"),y.Lc(31,ne,5,7,"li",7),y.ac(),y.ac(),y.ac(),y.Wb(32,"hr"),y.bc(33,"div",12),y.bc(34,"button",13),y.ic("click",(function(){return t.cancelAddItems()})),y.Mc(35,"Cancelar"),y.ac(),y.bc(36,"button",14),y.ic("click",(function(){return t.addItemsToWorkOrder()})),y.Mc(37,"A\xf1adir items"),y.ac(),y.ac(),y.ac()),2&e&&(y.Jb(6),y.uc("ngIf",t.clearFilterIsVisible),y.Jb(17),y.uc("ngForOf",y.pc(24,3,t.lsMaintenanceItemsTemp,y.xc(6,ce,t.p))),y.Jb(8),y.uc("ngForOf",t.lsItemsToAddSelected))},directives:[a.o,a.n,X.c],pipes:[X.b,a.w,a.x,a.d],styles:[".container__content[_ngcontent-%COMP%]{width:1248px;height:auto}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr!important;grid-template-rows:1fr;justify-content:space-between}label[_ngcontent-%COMP%]{cursor:pointer}.clear_filter[_ngcontent-%COMP%]{position:absolute;z-index:50;top:160px;left:95%;color:red}.container___col[_ngcontent-%COMP%]{width:100%}input[_ngcontent-%COMP%]{width:inherit}#container__table_resume[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}#container__resume[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px 10px 10px 20px;width:400px;height:500px;overflow-y:scroll;margin-right:20px}.title_resume[_ngcontent-%COMP%]{margin-bottom:20px}",'.container__checkbox[_ngcontent-%COMP%]{display:block;position:relative;padding-left:3px;padding-right:3px;margin-bottom:12px;cursor:pointer;font-size:22px;-webkit-user-select:none;user-select:none}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:20px;width:20px;background-color:#eee;border:1px solid #686d76;border-radius:5px}.container__checkbox[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%] ~ .checkmark[_ngcontent-%COMP%]{background-color:#ccc}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background-color:#81b214;border-radius:50%;border:none}.checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.container__checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled ~ .checkmark[_ngcontent-%COMP%]{border:1px solid #686d76;border-radius:5px}.container__checkbox[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:8px;top:5px;width:5px;height:10px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg)}',"select[_ngcontent-%COMP%]{cursor:pointer}.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}.btn-add[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{cursor:pointer}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;position:relative;left:93%;margin-bottom:20px;top:30px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px;margin-left:250px}.container__row_buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;justify-content:right;margin-top:30px}.container__row_buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin-bottom:20px}@media only screen and (max-width:600px){.col-mobile-hide[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{left:80vw}}"]}),ie),ae=r("KBxE"),oe=r("9Wwi");function se(e,t){1&e&&(y.bc(0,"div",44),y.bc(1,"p"),y.Mc(2,"* La sucursal es un campo obligatorio"),y.ac(),y.ac())}function le(e,t){1&e&&(y.bc(0,"div",44),y.bc(1,"p"),y.Mc(2,"* La rutina de mantenimiento es un campo obligatorio"),y.ac(),y.ac())}function ue(e,t){1&e&&(y.bc(0,"div",45),y.bc(1,"span"),y.Mc(2,"No se puede guardar la orden de trabajo puesto que hay campos obligatorios sin diligenciar"),y.ac(),y.ac())}function de(e,t){if(1&e){var n=y.cc();y.bc(0,"app-alert-error",46),y.ic("onAlertWasClose",(function(){return y.Dc(n),y.mc().closeErrorMessage()})),y.ac()}if(2&e){var i=y.mc();y.uc("title",i.errorTitle)("errorMessage",i.errorMessageApi)}}function he(e,t){1&e&&y.Wb(0,"app-img-loading")}var pe,fe=function(){return[]},be=((pe=function(){function e(t,n,i,r,a,s,l,u,d,h,p,f,b,m){c(this,e),this.ClientService=t,this.vehicleService=n,this.contractService=i,this.branchService=r,this.maintenanceRoutineService=a,this.maintenanceItemService=s,this.notificationService=l,this.movementService=u,this.transactionService=d,this.quotaService=h,this.dealerService=p,this.maintenanceItemManagerService=f,this.router=b,this.alertService=m,this.lsMaintenanceItems=[],this.lsMaintenanceItemsSelected=[],this.ORDEN_DE_TRABAJO=4,this.workOrderWasCanceled=new y.q,this.workOrderWasSaved=new y.q,this.isErrorVisible=!1,this.errorTitle="",this.errorMessageApi="",this.frmWorkOrder=new o.j({txtYear:new o.g(""),txtMileage:new o.g(""),txtBrand:new o.g(""),txtVehicleType:new o.g(""),txtVehicleModel:new o.g(""),txtClientDocument:new o.g(""),txtClient:new o.g(""),txtContract:new o.g(""),txtDealer:new o.g(""),txtObservation:new o.g("",[o.z.required,o.z.pattern(/^(\s+\S+\s*)*(?!\s).*$/)]),txtCurrentQuota:new o.g(""),txtConsumedQuota:new o.g(""),txtInTransitQuota:new o.g("")}),this.totalTaxes=0,this.totalWithoutTaxes=0,this.totalWithoutTaxesAndDiscount=0,this.totalDiscount=0,this.fieldBranchIsInvalid=!0,this.fieldMaintenanceRoutineIsInvalid=!0}var n,r,a,s;return i(e,[{key:"ngOnChanges",value:function(e){this.clearBufferForm(),this.getDealer()}},{key:"clearBufferForm",value:function(){this.frmWorkOrder.reset(),this.vehicleSelected=null,this.vehicleModelSelected=null,this.branchSelected=null,this.contractSelected=null,this.routineSelected=null,this.lsMaintenanceItems=[],this.lsMaintenanceItemsSelected=[],this.getDealer()}},{key:"ngOnInit",value:function(){this.getDealer(),this.initComponents()}},{key:"getDealer",value:function(){var e=this,t=JSON.parse(sessionStorage.getItem("sessionUser"));this.dealerService.getDealerById(t.company.id).subscribe((function(t){e.dealer=t,e.frmWorkOrder.controls.txtDealer.setValue(e.dealer.name.toUpperCase())}))}},{key:"initComponents",value:function(){this.oCountChanges=0,this.isAwaiting=!1,this.sharedFunctions=new O.a,this.getLsMovements()}},{key:"getPricesByContract",value:function(e){var t=this;this.maintenanceItemService.getPricesByContract(e).subscribe((function(e){t.pricesByContract=e;try{if(!t.contractSelected.client.contractualInformation)throw Error("El cliente a\xfan no tiene configurado un contrato con Renting Automayor, por favor comuniquese con el administrador de la plataforma.")}catch(n){t.clearFrmWorkOrder(),t.resetItemsToRoutine(),t.resetMaintenanceItems(),t.resetMaintenanceRoutines(),t.isErrorVisible=!0,t.errorTitle="Error validando la informaci\xf3n del cliente asociado a la placa",t.errorMessageApi=n}}))}},{key:"getLsMovements",value:function(){var e=this;try{this.movementService.getMovements().then((function(t){e.lsMovements=t}))}catch(t){console.warn(t)}}},{key:"searchVehicleOwner",value:(s=t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.ClientService.getClientById(t).then((function(e){}))}catch(n){console.warn(n)}case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"SetDataInForm",value:(a=t(regeneratorRuntime.mark((function e(){var t,n,i,c,r,a,o,s,l,u,d,h,p=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.frmWorkOrder.controls,n=t.txtYear,i=t.txtMileage,c=t.txtBrand,r=t.txtVehicleType,a=t.txtVehicleModel,o=t.txtClient,s=t.txtClientDocument,l=t.txtContract,u=t.txtCurrentQuota,d=t.txtConsumedQuota,h=t.txtInTransitQuota,this.resetItemsToRoutine(),this.resetMaintenanceItems(),this.vehicleSelected=this.vehicleService.getVehicle(),1==this.vehicleSelected.vehicleState.id){e.next=4;break}throw new Error("El veh\xedculo que seleccion\xf3 se encuentra en un estado INACTIVO, por favor comuniquese con el administrador");case 4:this.contractService.getContractByVehicleId(this.vehicleSelected.id).then((function(e){if(p.contractSelected=e,null==p.contractSelected)throw new Error("El veh\xedculo que ingres\xf3 no tienen un contrato v\xednculado, por favor comuniquese con el administrador");if(p.contractSelected.contractState.id!=I.a.ACTIVO)throw new Error("El veh\xedculo que intenta asociar cuenta con un contrato en estado: ".concat(p.contractSelected.contractState.name," , por tal motivo, NO se puede generar una orden de trabajo. Por favor comuniquese con el administrador."));n.setValue(p.vehicleSelected.year),i.setValue(p.sharedFunctions.formatNumberToString(p.vehicleSelected.mileage)),c.setValue(p.vehicleSelected.vehicleModel.brand.name.toUpperCase()),r.setValue(p.vehicleSelected.vehicleModel.type.name.toUpperCase()),a.setValue(p.vehicleSelected.vehicleModel.shortName.toUpperCase()),s.setValue(p.contractSelected.client.document),o.setValue(p.contractSelected.client.name.toUpperCase()),l.setValue("".concat(p.contractSelected.code," - ").concat(p.contractSelected.name)),p.vehicleModelSelected=p.vehicleSelected.vehicleModel,p.getPricesByContract(p.contractSelected.id),p.quotaService.getFinancialInformationByClient(p.contractSelected.client.id).subscribe((function(e){if(null==e||null==e)throw new Error("El cliente no tiene un cupo asignado a\xfan, por favor comuniquese con el administrador para que se realice la correspondiente gesti\xf3n.");var t=e;u.setValue(p.sharedFunctions.formatNumberToString(parseFloat(t.currentQuota.toString()))),d.setValue(p.sharedFunctions.formatNumberToString(parseFloat(t.consumedQuota.toString()))),h.setValue(p.sharedFunctions.formatNumberToString(parseFloat(t.inTransitQuota.toString())))}),(function(e){p.clearFrmWorkOrder(),p.resetItemsToRoutine(),p.resetMaintenanceItems(),p.resetMaintenanceRoutines(),p.isErrorVisible=!0,p.errorTitle="Error validando la informaci\xf3n del cliente.",p.errorMessageApi=e}))})).catch((function(e){p.clearFrmWorkOrder(),p.resetItemsToRoutine(),p.resetMaintenanceItems(),p.resetMaintenanceRoutines(),p.isErrorVisible=!0,p.errorTitle="Error validando la informaci\xf3n del veh\xedculo",p.errorMessageApi=e})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(e.t0),this.isErrorVisible=!0,this.errorTitle="Error validando la informaci\xf3n del veh\xedculo",this.errorMessageApi=e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return a.apply(this,arguments)})},{key:"setBranchSelected",value:function(){this.branchSelected=this.branchService.getBranchSelected(),this.fieldBranchIsInvalid=null==this.branchSelected||null==this.branchSelected}},{key:"showMaintenanceItems",value:function(e){var t=this;if(this.resetItemsToRoutine(),this.routineSelected=e,null==this.routineSelected||null==this.routineSelected)this.fieldMaintenanceRoutineIsInvalid=!0,this.lsMaintenanceItems=[],this.lsMaintenanceItemsSelected=[];else{var n=null;this.maintenanceItemService.getItemRAAdministration().subscribe((function(i){n=i,t.fieldMaintenanceRoutineIsInvalid=!1,t.lsMaintenanceItems=e.lsItems,t.lsMaintenanceItems.push(n),t.lsMaintenanceItemsSelected=t.lsMaintenanceItems,t.updateReferencePrices(t.lsMaintenanceItems,t.pricesByContract.lsMaintenanceItems)}))}}},{key:"updateReferencePrices",value:function(e,t){var n=[];e.forEach((function(e){try{var i=t.find((function(t){return t.id==e.id}));n.push(i)}catch(c){console.log("no se encontro item\n        para actualizar precio")}})),console.log("updateReferencePrices"),console.log(n),this.lsMaintenanceItems=this.maintenanceItemManagerService.updatePrices(e,n)}},{key:"resetItemsToRoutine",value:function(){this.lsMaintenanceItemsSelected=[]}},{key:"resetMaintenanceItems",value:function(){this.lsMaintenanceItems=[]}},{key:"resetMaintenanceRoutines",value:function(){this.vehicleModelSelected=new P,this.vehicleModelSelected.id=0,this.vehicleService.setVehicleModelSelected(null)}},{key:"addItemToRoutine",value:function(e){null!=this.lsMaintenanceItemsSelected&&null!=this.lsMaintenanceItemsSelected||this.resetItemsToRoutine(),this.lsMaintenanceItemsSelected.push(e)}},{key:"deleteItemToRoutine",value:function(e){var t=this.lsMaintenanceItemsSelected.find((function(t){return t.id==e.id})),n=this.lsMaintenanceItemsSelected.indexOf(t);this.lsMaintenanceItemsSelected.splice(n,1)}},{key:"clearFrmWorkOrder",value:function(){this.frmWorkOrder.reset(),this.fieldBranchIsInvalid=!0,this.fieldMaintenanceRoutineIsInvalid=!0}},{key:"formatNumberToString",value:function(e){return this.sharedFunctions.formatNumberToString(e)}},{key:"sendEmail",value:(r=t(regeneratorRuntime.mark((function e(t){var n,i,c,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ClientService.getClientById(this.contractSelected.client.id);case 2:return n=e.sent,i=n.contacts,e.next=6,this.transactionService.getTransactionsByDealerOrClient(t.headerDetails.dealer.id,null,null,null,null,null,null).toPromise();case 6:c=e.sent,(r={nameMessage:"Fleet Service",emailReceiver:i.filter((function(e){return 1==e.mustNotify})).map((function(e){return e.email})),typemessage:t.movement.id,nOrderwork:c[0].code,nDealer:t.headerDetails.dealer.name}).emailReceiver.length>0&&this.notificationService.sendMail(r).subscribe((function(e){}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"saveWorkOrder",value:(n=t(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.alertService.confirm("\xbfEst\xe1 seguro de guardar los datos de esta Orden de trabajo?",(function(){var e=t.setDataToWorkOrder();t.isAwaiting=!0,t.quotaService.getFinancialInformationByClient(e.client.id).subscribe((function(n){parseFloat(n.currentQuota.toString())-e.value>0?t.transactionService.processTransaction(e).subscribe((function(n){var i=n;i.response&&(t.sendEmail(e),t.alertService.succes(i.message),t.clearBufferForm(),t.isAwaiting=!1,t.workOrderWasSaved.emit(!0))})):(t.isAwaiting=!1,t.isErrorVisible=!0,t.errorTitle="Error intentando procesar la \xf3rden de trabajo",t.errorMessageApi="\xa1No se puede procesar esta \xf3rden de trabajo puesto que el cliente no cuenta con el suficiente cupo disponible!")}))}))}catch(n){this.alertService.error(n),this.isErrorVisible=!0,this.errorTitle="Error intentando procesar la \xf3rden de trabajo",this.errorMessageApi=n}case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setDataToWorkOrder",value:function(){var e=this;try{var t=this.frmWorkOrder.controls,n=t.txtObservation,i=t.txtMileage,c=new d.a;c.movement=this.lsMovements.find((function(t){return t.id==e.ORDEN_DE_TRABAJO})),c.valueWithoutDiscount=this.totalWithoutTaxes,c.discountValue=this.totalDiscount,c.valueWithDiscountWithoutTaxes=this.totalWithoutTaxesAndDiscount,c.taxesValue=this.totalTaxes,c.value=this.totalRoutine,c.client=this.contractSelected.client,c.usu_id=h.a.validateUserLogged();var r=new b.a;if(r.dealer=this.dealer,null==this.branchSelected||null==this.branchSelected)throw new Error("La sucursal es un dato obligatorio para poder cerrar la orden de trabajo");if(r.branch=this.branchSelected,null==this.vehicleSelected||null==this.vehicleSelected)throw new Error("El veh\xedculo ingresado no es v\xe1lido, por favor rectifique la placa");r.vehicle=this.vehicleSelected,r.vehicle.mileage=i.value.replace(/\,/g,""),null==this.routineSelected||null==this.routineSelected?this.fieldMaintenanceRoutineIsInvalid=!0:r.maintenanceRoutine=this.routineSelected,r.contract=this.contractSelected,c.headerDetails=r,c.lsItems=this.lsMaintenanceItemsSelected;var a=[],o=new m.a,s=n.value;return""!=s.toString().trim()&&(o.description=s,o.usu_id=h.a.validateUserLogged(),a.push(o)),c.lsObservations=a,c}catch(l){return this.isErrorVisible=!0,this.errorTitle="Error inentando procesar la \xf3rden de trabajo.",this.errorMessageApi=l,null}}},{key:"formatMileageToString",value:function(e){var t=e.target.value.toString().replace(/\,/g,"");e.target.value=this.formatNumberToString(t)}},{key:"closeWorkOrder",value:function(){confirm("\xbfest\xe1 seguro que desea cerrar la orden de trabajo?, s\xed lo realiza se perderan todos los cambios consignados ac\xe1")&&(this.clearFrmWorkOrder(),this.clearBufferForm(),this.workOrderWasCanceled.emit(!0))}},{key:"closePopUp",value:function(e){document.getElementById(e).style.display="none"}},{key:"openPopUp",value:function(e){this.oCountChanges+=1,document.getElementById(e).style.display="block"}},{key:"goToUp",value:function(){window.scroll(0,0)}},{key:"addNewMaintenanceItemsToRoutine",value:function(e){var t=this;e.forEach((function(e){try{t.lsMaintenanceItems.find((function(t){return t.id==e.id}))?console.warn("[addNewMaintenanceItemsToRoutine]: Ya existe el item seleccionado en la rutina"):(e.amount=0,t.lsMaintenanceItems.unshift(e))}catch(n){console.warn(n)}})),window.scroll(0,1e3),this.closePopUp("container__addItems")}},{key:"calculateDiscount",value:function(e){}},{key:"setItemsToRoutine",value:function(e){this.lsMaintenanceItemsSelected=e,console.log("Items selecccionados para la rutina"),console.log(this.lsMaintenanceItemsSelected)}},{key:"setTotalRoutine",value:function(e){this.totalWithoutTaxesAndDiscount=e.valueWithDiscountWithoutTaxes,this.totalWithoutTaxes=e.valueWithoutDiscount,this.totalTaxes=e.taxesValue,this.totalDiscount=e.discountValue,this.totalRoutine=e.value}},{key:"closeErrorMessage",value:function(){this.isErrorVisible=!1,this.workOrderWasCanceled.emit(!0)}}]),e}()).\u0275fac=function(e){return new(e||pe)(y.Vb(k.a),y.Vb(R.a),y.Vb(W.a),y.Vb(T.a),y.Vb(D.a),y.Vb(A.a),y.Vb(x.a),y.Vb(w.a),y.Vb(M.a),y.Vb(F.a),y.Vb(C.a),y.Vb(B.a),y.Vb(l.b),y.Vb(L.a))},pe.\u0275cmp=y.Pb({type:pe,selectors:[["app-work-order"]],outputs:{workOrderWasCanceled:"workOrderWasCanceled",workOrderWasSaved:"workOrderWasSaved"},features:[y.Hb],decls:111,vars:17,consts:[[1,"card"],[3,"formGroup"],["id","container__header",1,"card-header"],[1,"container__buttonClose"],[3,"click"],[1,"fas","fa-times"],[1,"card-body"],["role","alert",1,"alert","alert-primary"],[1,"container__row"],[1,"container__col"],[3,"vehicleSelected","vehicleWasSetted"],["type","number","formControlName","txtYear","placeholder","Modelo","disabled","",1,"form-control"],["type","text","formControlName","txtMileage","placeholder","Kilometraje",1,"form-control",3,"input"],["type","text","formControlName","txtBrand","placeholder","Marca","disabled","",1,"form-control"],["type","text","formControlName","txtVehicleType","placeholder","Tipo","disabled","",1,"form-control"],["type","text","formControlName","txtVehicleModel","placeholder","L\xednea","disabled","",1,"form-control"],["type","text","formControlName","txtClientDocument","placeholder","NIT ...","disabled","",1,"form-control"],["type","text","formControlName","txtClient","placeholder","Cliente ...","disabled","",1,"form-control"],["type","text","formControlName","txtContract","placeholder","Contrato ...","disabled","",1,"form-control"],["type","text","formControlName","txtCurrentQuota","placeholder","Cupo disponible ...","disabled","",1,"form-control"],["type","text","formControlName","txtConsumedQuota","placeholder","Cupo consumido ...","disabled","",1,"form-control"],["type","text","formControlName","txtInTransitQuota","placeholder","Cupo en tr\xe1nsito ...","disabled","",1,"form-control"],["type","text","formControlName","txtDealer","placeholder","Concesionario ...","disabled","",1,"form-control"],[3,"dealer","branchSelected","branchWasSetted"],["class","error",4,"ngIf"],[3,"areRoutineFiltered","vehicleModel","onRoutineWasChanged"],[1,"btn-add","btn-info",3,"click"],[1,"fas","fa-plus"],[1,"container-table-items"],[3,"maintenanceItems","maintenanceItemsSelected","contract","onItemsWereSelected","onRoutineWasCalculated"],["formControlName","txtObservation","cols","30","rows","2",1,"form-control"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],["class","container__infoError","id","cont_error_add_work_order",4,"ngIf"],["id","container__addItems"],[1,"overlay"],[1,"card","card-review"],[1,"card-header","container__header"],[1,"fas","fa-times",3,"click"],["id","container__tableAddNewItems",1,"card-body"],[3,"lsMaintenanceItems","newItemsWasSetted","addItemsWasCanceled"],[3,"title","errorMessage","onAlertWasClose",4,"ngIf"],[4,"ngIf"],[1,"error"],["id","cont_error_add_work_order",1,"container__infoError"],[3,"title","errorMessage","onAlertWasClose"]],template:function(e,t){1&e&&(y.bc(0,"div",0),y.bc(1,"form",1),y.bc(2,"div",2),y.bc(3,"legend"),y.Mc(4,"Nueva orden de trabajo"),y.ac(),y.bc(5,"div",3),y.bc(6,"a",4),y.ic("click",(function(){return t.closeWorkOrder()})),y.Wb(7,"i",5),y.ac(),y.ac(),y.ac(),y.bc(8,"div",6),y.bc(9,"legend"),y.Mc(10,"Datos del veh\xedculo"),y.ac(),y.bc(11,"div",7),y.Mc(12," \xa1 No se te olvide actualizar el kilometraje del veh\xedculo ! "),y.ac(),y.bc(13,"div",8),y.bc(14,"div",9),y.bc(15,"app-input-search-vehicle",10),y.ic("vehicleWasSetted",(function(){return t.SetDataInForm()})),y.ac(),y.ac(),y.bc(16,"div",9),y.bc(17,"label"),y.Mc(18,"Modelo"),y.ac(),y.Wb(19,"input",11),y.ac(),y.bc(20,"div",9),y.bc(21,"label"),y.Mc(22,"Kilometraje"),y.ac(),y.bc(23,"input",12),y.ic("input",(function(e){return t.formatMileageToString(e)})),y.ac(),y.ac(),y.ac(),y.bc(24,"div",8),y.bc(25,"div",9),y.bc(26,"label"),y.Mc(27,"Marca"),y.ac(),y.Wb(28,"input",13),y.ac(),y.bc(29,"div",9),y.bc(30,"label"),y.Mc(31,"Tipo"),y.ac(),y.Wb(32,"input",14),y.ac(),y.bc(33,"div",9),y.bc(34,"label"),y.Mc(35,"L\xednea"),y.ac(),y.Wb(36,"input",15),y.ac(),y.ac(),y.Wb(37,"hr"),y.bc(38,"legend"),y.Mc(39,"Datos del cliente"),y.ac(),y.bc(40,"div",8),y.bc(41,"div",9),y.bc(42,"label"),y.Mc(43,"Documento"),y.ac(),y.Wb(44,"input",16),y.ac(),y.bc(45,"div",9),y.bc(46,"label"),y.Mc(47,"Nombre"),y.ac(),y.Wb(48,"input",17),y.ac(),y.bc(49,"div",9),y.bc(50,"label"),y.Mc(51,"Contrato"),y.ac(),y.Wb(52,"input",18),y.ac(),y.ac(),y.bc(53,"div",8),y.bc(54,"div",9),y.bc(55,"label"),y.Mc(56,"Cupo disponible"),y.ac(),y.Wb(57,"input",19),y.ac(),y.bc(58,"div",9),y.bc(59,"label"),y.Mc(60,"Cupo consumido"),y.ac(),y.Wb(61,"input",20),y.ac(),y.bc(62,"div",9),y.bc(63,"label"),y.Mc(64,"Cupo en tr\xe1nsito"),y.ac(),y.Wb(65,"input",21),y.ac(),y.ac(),y.Wb(66,"hr"),y.bc(67,"legend"),y.Mc(68,"Datos de la orden"),y.ac(),y.bc(69,"div",8),y.bc(70,"div",9),y.bc(71,"label"),y.Mc(72,"Concesionario"),y.ac(),y.Wb(73,"input",22),y.ac(),y.bc(74,"div",9),y.bc(75,"app-branch-by-dealer",23),y.ic("branchWasSetted",(function(){return t.setBranchSelected()})),y.ac(),y.Lc(76,se,3,0,"div",24),y.ac(),y.bc(77,"div",9),y.bc(78,"app-routines-by-vehicle-model",25),y.ic("onRoutineWasChanged",(function(e){return t.showMaintenanceItems(e)})),y.ac(),y.Lc(79,le,3,0,"div",24),y.ac(),y.ac(),y.Wb(80,"hr"),y.bc(81,"legend"),y.Mc(82,"Items \xf3rden de trabajo"),y.ac(),y.bc(83,"button",26),y.ic("click",(function(){return t.openPopUp("container__addItems"),t.goToUp()})),y.Wb(84,"i",27),y.ac(),y.bc(85,"div",28),y.bc(86,"app-tbl-check-items-for-routine",29),y.ic("onItemsWereSelected",(function(e){return t.setItemsToRoutine(e)}))("onRoutineWasCalculated",(function(e){return t.setTotalRoutine(e)})),y.ac(),y.ac(),y.bc(87,"legend"),y.Mc(88,"Observaciones"),y.ac(),y.bc(89,"div"),y.Wb(90,"textarea",30),y.ac(),y.bc(91,"div",31),y.bc(92,"button",32),y.ic("click",(function(){return t.closeWorkOrder()})),y.Mc(93," Cancelar "),y.ac(),y.bc(94,"button",33),y.ic("click",(function(){return t.saveWorkOrder()})),y.Mc(95," Guardar "),y.ac(),y.ac(),y.bc(96,"div"),y.Lc(97,ue,3,0,"div",34),y.ac(),y.ac(),y.ac(),y.ac(),y.bc(98,"div",35),y.bc(99,"div",36),y.bc(100,"div",37),y.bc(101,"div",38),y.bc(102,"h2"),y.Mc(103,"A\xf1adir item a la orden de trabajo"),y.ac(),y.bc(104,"div",3),y.bc(105,"a"),y.bc(106,"i",39),y.ic("click",(function(){return t.closePopUp("container__addItems")})),y.ac(),y.ac(),y.ac(),y.ac(),y.bc(107,"div",40),y.bc(108,"app-tbl-items-to-add",41),y.ic("newItemsWasSetted",(function(e){return t.addNewMaintenanceItemsToRoutine(e)}))("addItemsWasCanceled",(function(){return t.closePopUp("container__addItems")})),y.ac(),y.ac(),y.ac(),y.ac(),y.ac(),y.Lc(109,de,1,2,"app-alert-error",42),y.Lc(110,he,1,0,"app-img-loading",43)),2&e&&(y.Jb(1),y.uc("formGroup",t.frmWorkOrder),y.Jb(14),y.uc("vehicleSelected",t.vehicleSelected),y.Jb(60),y.uc("dealer",t.dealer)("branchSelected",t.branchSelected),y.Jb(1),y.uc("ngIf",t.fieldBranchIsInvalid),y.Jb(2),y.uc("areRoutineFiltered",!0)("vehicleModel",t.vehicleModelSelected),y.Jb(1),y.uc("ngIf",t.fieldMaintenanceRoutineIsInvalid),y.Jb(7),y.uc("maintenanceItems",t.lsMaintenanceItems)("maintenanceItemsSelected",t.lsMaintenanceItemsSelected)("contract",t.contractSelected),y.Jb(8),y.uc("disabled",t.fieldBranchIsInvalid||t.fieldMaintenanceRoutineIsInvalid||t.frmWorkOrder.invalid),y.Jb(3),y.uc("ngIf",t.fieldBranchIsInvalid||t.fieldMaintenanceRoutineIsInvalid||t.frmWorkOrder.invalid),y.Jb(11),y.uc("lsMaintenanceItems",null!=t.pricesByContract?t.pricesByContract.lsMaintenanceItems:y.wc(16,fe)),y.Jb(1),y.uc("ngIf",t.isErrorVisible),y.Jb(1),y.uc("ngIf",t.isAwaiting))},directives:[o.B,o.r,o.k,z,o.v,o.c,o.q,o.i,H,a.o,Y,Z.a,re,ae.a,oe.a],styles:['.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr;justify-content:space-between}.container__col[_ngcontent-%COMP%]{padding:10px}label[_ngcontent-%COMP%]{cursor:pointer}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin-bottom:20px}.container__buttonClose[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px;position:relative;float:right}.container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;padding-top:20px}.error[_ngcontent-%COMP%]{color:red;margin-top:10px}.container__infoError[_ngcontent-%COMP%]:before{position:absolute;content:"";display:block;width:0;height:0;left:50%;margin-left:-10px;margin-top:-30px;border:10px solid transparent;border-bottom-color:#ebd4d4}.container__infoError[_ngcontent-%COMP%]{background-color:#ebd4d4;cursor:pointer;position:absolute;padding:10px 15px;z-index:50;width:200px;height:auto;border-radius:20px;right:3%;margin-top:30px;box-shadow:10px 10px 17px -7px rgba(0,0,0,.75)}.bold[_ngcontent-%COMP%]{font-weight:700}.last-row[_ngcontent-%COMP%]{border-top:2px solid #000;border-bottom:1px solid #000}#container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}#container__addItems[_ngcontent-%COMP%]{display:none}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%}',"select[_ngcontent-%COMP%]{cursor:pointer}.container__row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}.btn-add[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{cursor:pointer}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;position:relative;left:93%;margin-bottom:20px;top:30px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px;margin-left:250px}.container__row_buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;justify-content:right;margin-top:30px}.container__row_buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%}.container__buttonClose[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;margin-bottom:20px}@media only screen and (max-width:600px){.col-mobile-hide[_ngcontent-%COMP%]{display:none}.btn-add[_ngcontent-%COMP%]{left:80vw}}"]}),pe),me=r("3+Ze"),ge=r("wAkH"),ve=r("ZyAM");function _e(e,t){if(1&e&&(y.bc(0,"option",10),y.Mc(1),y.nc(2,"titlecase"),y.ac()),2&e){var n=t.$implicit;y.uc("value",n.id),y.Jb(1),y.Oc(" ",y.oc(2,2,n.name)," ")}}function ye(e,t){if(1&e){var n=y.cc();y.bc(0,"div",4),y.bc(1,"app-input-search-dealer",40),y.ic("dealerWasSetted",(function(){return y.Dc(n),y.mc().setDealerToFilter()})),y.ac(),y.ac()}if(2&e){var i=y.mc();y.Jb(1),y.uc("countChanges",i.countChanges)}}function Me(e,t){if(1&e){var n=y.cc();y.bc(0,"div",4),y.bc(1,"app-input-search-client",41),y.ic("clientWasSetted",(function(){return y.Dc(n),y.mc().setClientToFilter()})),y.ac(),y.ac()}if(2&e){var i=y.mc();y.Jb(1),y.uc("countChanges",i.countChanges)}}function xe(e,t){if(1&e){var n=y.cc();y.bc(0,"button",42),y.ic("click",(function(){return y.Dc(n),y.mc().toggleBtnFilter()})),y.Mc(1," Filtrar "),y.ac()}}function Ce(e,t){if(1&e){var n=y.cc();y.bc(0,"button",43),y.ic("click",(function(){return y.Dc(n),y.mc().toggleBtnFilter()})),y.Mc(1," \xd7 Quitar filtros "),y.ac()}}function ke(e,t){if(1&e){var n=y.cc();y.bc(0,"button",44),y.ic("click",(function(){return y.Dc(n),y.mc().openWorkOrder()})),y.Wb(1,"i",45),y.ac()}}function we(e,t){if(1&e){var n=y.cc();y.bc(0,"div"),y.bc(1,"i",50),y.ic("click",(function(){y.Dc(n);var e=y.mc(2).$implicit,t=y.mc();return t.setTransaction(e),t.openPopUp("container__FinalizeWorkOrder")})),y.ac(),y.bc(2,"i",51),y.ic("click",(function(){y.Dc(n);var e=y.mc(2).$implicit,t=y.mc();return t.setTransaction(e),t.openPopUp("container__Cancelation")})),y.ac(),y.ac()}}function Se(e,t){1&e&&(y.bc(0,"div"),y.Lc(1,we,3,0,"div",49),y.ac()),2&e&&(y.Jb(1),y.uc("ngSwitchCase",1))}function Ie(e,t){if(1&e){var n=y.cc();y.bc(0,"div"),y.bc(1,"i",51),y.ic("click",(function(){y.Dc(n);var e=y.mc(2).$implicit,t=y.mc();return t.setTransaction(e),t.openPopUp("container__Cancelation")})),y.ac(),y.ac()}}function Oe(e,t){1&e&&(y.bc(0,"div"),y.Lc(1,Ie,2,0,"div",49),y.ac()),2&e&&(y.Jb(1),y.uc("ngSwitchCase",2))}function Pe(e,t){if(1&e){var n=y.cc();y.bc(0,"div"),y.bc(1,"i",52),y.ic("click",(function(){y.Dc(n);var e=y.mc(2).$implicit,t=y.mc();return t.setTransaction(e),t.openPopUp("container__Cancelation")})),y.ac(),y.ac()}}function Re(e,t){1&e&&(y.bc(0,"div"),y.Lc(1,Pe,2,0,"div",49),y.ac()),2&e&&(y.Jb(1),y.uc("ngSwitchCase",3))}function We(e,t){if(1&e){var n=y.cc();y.bc(0,"tr"),y.bc(1,"td"),y.Mc(2),y.ac(),y.bc(3,"td"),y.Mc(4),y.ac(),y.bc(5,"td"),y.Mc(6),y.ac(),y.bc(7,"td"),y.Mc(8),y.ac(),y.bc(9,"td"),y.Mc(10),y.ac(),y.bc(11,"td"),y.Mc(12),y.nc(13,"uppercase"),y.ac(),y.bc(14,"td"),y.Mc(15),y.nc(16,"date"),y.nc(17,"date"),y.ac(),y.bc(18,"td"),y.Mc(19),y.nc(20,"currency"),y.ac(),y.bc(21,"td"),y.bc(22,"span",46),y.Mc(23),y.ac(),y.ac(),y.bc(24,"td"),y.bc(25,"i",47),y.ic("click",(function(){y.Dc(n);var e=t.$implicit,i=y.mc();return i.setTransaction(e),i.openPopUp("container__resume_main")})),y.ac(),y.bc(26,"div",48),y.Lc(27,Se,2,1,"div",39),y.Lc(28,Oe,2,1,"div",39),y.Lc(29,Re,2,1,"div",39),y.ac(),y.ac(),y.ac()}if(2&e){var i=t.$implicit,c=t.index,r=y.mc();y.Jb(2),y.Nc(c+1),y.Jb(2),y.Nc(null!=i.code?i.code:""),y.Jb(2),y.Nc(i.headerDetails.vehicle.licensePlate),y.Jb(2),y.Nc(i.client.name),y.Jb(2),y.Nc(i.headerDetails.maintenanceRoutine.name),y.Jb(2),y.Nc(y.oc(13,14,i.headerDetails.branch.name)),y.Jb(3),y.Oc(" ",null!=i.updateDate?y.pc(16,16,i.updateDate,"yyyy/MM/dd"):y.pc(17,19,i.registrationDate,"yyyy/MM/dd")," "),y.Jb(4),y.Nc(y.rc(20,22,i.value,"USD","symbol","1.0-0")),y.Jb(3),y.uc("id",r.getSpanStateId(i.id)),y.Jb(1),y.Nc(r.validateState(i.transactionState,i.id)),y.Jb(3),y.uc("ngSwitch",r.validateContainerControls(i)),y.Jb(1),y.uc("ngIf",r.isDealer),y.Jb(1),y.uc("ngIf",r.isDealer),y.Jb(1),y.uc("ngIf",r.isDealer)}}function Te(e,t){1&e&&y.Wb(0,"app-img-loading")}var De,Ae,Fe,Be=function(){return{dateInputFormat:"YYYY/MM/DD",containerClass:"theme-dark-blue"}},Le=[{path:"",component:u.a,children:[{path:"",component:(De=function(){function e(t,n,i,r,a,s,l){c(this,e),this.transactionService=t,this.notificationService=n,this.datePipe=i,this.dealerService=r,this.clientService=a,this.movementService=s,this.currency=l,this.transactionSelected=new d.a,this.trx_id=0,this.isDealer=!1,this.isMainCompany=!1,this.isFiltered=!1,this.countChanges=0,this.frm_filter=new o.j({txtCode:new o.g(""),txtLicense_plate:new o.g(""),txtInit_date:new o.g(""),txtEnd_date:new o.g(""),cmbState:new o.g("")}),this.frmApprovedTrx=new o.j({txtObservationApprobation:new o.g("")}),this.frmCancelTrx=new o.j({txtObservationCancelation:new o.g("")})}var n,r,a,s,l,u,g,y,M;return i(e,[{key:"ngOnInit",value:function(){this.initComponents()}},{key:"initComponents",value:(M=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dealerService.setDealerSelected(null),this.clientService.setClientSelected(null),this.countChanges+=1,this.isAwaiting=!1,this.getCompany(),e.next=7,this.transactionService.getTransactionStates();case 7:return this.lsTransactionStates=e.sent,this.getMovementList(),e.next=11,this.initDataToGetReport();case 11:return e.next=13,this.getDataTransactions();case 13:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"getMovementList",value:(y=t(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.movementService.getMovements().then((function(e){t.lsMovements=e}))}catch(n){console.warn(n)}case 1:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"getCompany",value:function(){this.company=h.a.validateUserAndCompany()}},{key:"initDataToGetReport",value:(g=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=(console.warn("[initDataToGetReport]",this.company),console.log(this.company),this.company.type),e.next=e.t0===p.a.CLIENT?3:e.t0===p.a.DEALER?5:e.t0===p.a.MAIN_COMPANY?7:8;break;case 3:return this.typeOfReport="dealer",this.isMainCompanyLogged=!1,this.client_to_filter=this.company.id,this.dealer_to_filter=null,this.isDealer=!1,e.abrupt("break",8);case 5:return this.typeOfReport="client",this.isMainCompanyLogged=!1,this.dealer_to_filter=this.company.id,this.client_to_filter=null,this.isDealer=!0,e.abrupt("break",8);case 7:this.typeOfReport="client",this.isMainCompanyLogged=!0,this.client_to_filter=null,this.dealer_to_filter=null,this.isDealer=!0,this.isMainCompany=!0;case 8:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getDataTransactions",value:(u=t(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.isAwaiting=!0,this.transactionService.getTransactionsByDealerOrClient(this.dealer_to_filter,this.client_to_filter,this.init_date,this.end_date,this.code_to_filter,this.license_plate_toFilter,this.state_to_filter).subscribe((function(e){t.lsWorkOrderByDealer=e.filter((function(e){return 3!=e.transactionState.id}))})),this.isAwaiting=!1}catch(n){console.warn(n)}case 1:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"validateState",value:function(e,t){var n="#"+this.getSpanStateId(t),i=document.querySelector(n);if(null!=e)switch(e.name.toUpperCase()){case"APROBADA":i.classList.add("tag-active");break;case"FINALIZADA":i.classList.add("tag-ending");break;case"RECHAZADA":i.classList.add("tag-error");break;case"ANULADA":i.classList.add("tag-canceled");break;default:i.classList.add("tag-pending")}else i.classList.add("tag-pending");return null!=e?e.name:"PENDIENTE"}},{key:"getSpanStateId",value:function(e){return"stateTrx_"+e}},{key:"openWorkOrder",value:function(){var e=document.querySelector("#container__table_workOrder"),t=document.querySelector("#container__workOrder");e.setAttribute("style","display:none"),t.setAttribute("style","display:block")}},{key:"closeWorkOrder",value:function(){var e=document.querySelector("#container__table_workOrder"),t=document.querySelector("#container__workOrder");e.setAttribute("style","display:block"),t.setAttribute("style","display:none")}},{key:"getListWorkOrders",value:function(){this.getDataTransactions(),this.closeWorkOrder()}},{key:"closePopUp",value:function(e){document.getElementById(e).style.display="none"}},{key:"openPopUp",value:function(e){document.getElementById(e).style.display="block"}},{key:"setTransaction",value:function(e){this.transactionSelected=e,this.trx_id=e.id}},{key:"toggleBtnFilter",value:(l=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isAwaiting=!0,this.isFiltered&&(this.frm_filter.reset(),this.dealerService.setDealerSelected(null),this.clientService.setClientSelected(null),this.countChanges+=1,this.initDataToGetReport()),this.isFiltered=!this.isFiltered,e.next=5,this.setDataToFilters();case 5:this.isAwaiting=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"setDataToFilters",value:(s=t(regeneratorRuntime.mark((function e(){var t,n,i,c,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.frm_filter.controls,n=t.txtCode,i=t.txtLicense_plate,c=t.txtInit_date,r=t.txtEnd_date,a=t.cmbState,this.code_to_filter=n.value,this.license_plate_toFilter=i.value,this.init_date=this.datePipe.transform(c.value,"yyyy/MM/dd"),this.end_date=this.datePipe.transform(r.value,"yyyy/MM/dd"),this.state_to_filter=a.value,this.getDataTransactions();case 2:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setDealerToFilter",value:function(){var e=this.dealerService.getDealerSelected();this.dealer_to_filter=null!=e?e.id:null}},{key:"setClientToFilter",value:function(){var e=this.clientService.getClientSelected();this.client_to_filter=null!=e?e.id:null}},{key:"sendEmail",value:(a=t(regeneratorRuntime.mark((function e(t){var n,i,c,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client.id,i=t.headerDetails.relatedTransaction.code,e.next=4,this.clientService.getClientById(n);case 4:c=e.sent,r=c.contacts,(a={nameMessage:"Fleet Service",emailReceiver:r.filter((function(e){return 1==e.mustNotify})).map((function(e){return e.email})),typemessage:t.movement.id,nOrderwork:i}).emailReceiver.length>0&&this.notificationService.sendMail(a).subscribe((function(e){console.log(e)}));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"finalizeWorkOrder",value:(r=t(regeneratorRuntime.mark((function e(){var t,n,i,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.isAwaiting=!0,t=this.lsMovements.find((function(e){return e.id==f.b.FINALIZACION_ORDEN_DE_TRABAJO})),n=this.frmApprovedTrx.controls.txtObservationApprobation,i=this.setDataTransaction(this.transactionSelected,t,n.value),this.sendEmail(i),this.transactionService.processTransaction(i).subscribe((function(e){e.response&&(c.sendEmail(i),v.a.fire({position:"center",icon:"success",title:e.message,showConfirmButton:!0}),c.getDataTransactions(),c.closePopUp("container__FinalizeWorkOrder"))})),this.isAwaiting=!1}catch(r){console.warn(r)}case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"cancelWorkOrder",value:(n=t(regeneratorRuntime.mark((function e(){var t,n,i,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.isAwaiting=!0,t=this.lsMovements.find((function(e){return e.id==f.b.ANULACION_ORDEN_DE_TRABAJO})),n=this.frmCancelTrx.controls.txtObservationCancelation,i=this.setDataTransaction(this.transactionSelected,t,n.value),this.transactionService.processTransaction(i).subscribe((function(e){e.response&&(v.a.fire({position:"center",icon:"success",title:e.message,showConfirmButton:!0}),c.getDataTransactions(),c.closePopUp("container__Cancelation"))})),this.isAwaiting=!1}catch(r){console.warn(r)}case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setDataTransaction",value:function(e,t,n){var i=new d.a;i.movement=t,i.value=e.value,i.usu_id=h.a.validateUserLogged(),i.client=e.client,i.headerDetails=new b.a,i.headerDetails.relatedTransaction=e;var c=new m.a;c.usu_id=h.a.validateUserLogged(),c.description=n;var r=[];return""!=n&&r.push(c),i.lsObservations=r,i}},{key:"clearForms",value:function(){this.frmApprovedTrx.reset(),this.frmCancelTrx.reset()}},{key:"validateContainerControls",value:function(e){var t=0;return"APROBADA"==e.transactionState.name.toUpperCase()&&(t=1),"PENDIENTE"==e.transactionState.name.toUpperCase()&&(t=2),"RECHAZADA"==e.transactionState.name.toUpperCase()&&(t=3),t}},{key:"downloadExcel",value:function(){var e=this,t=this.lsWorkOrderByDealer.map((function(t){return{Codigo:t.code,Placa:t.headerDetails.vehicle.licensePlate,Cliente:t.client.name,Mantenimiento:t.headerDetails.maintenanceRoutine.name,Sucursal:t.headerDetails.branch.name,Fecha:new Date(t.registrationDate).toLocaleDateString(),Valor:e.currency.transform(t.value),Estado:t.transactionState.name}}));_.a.convertArrayToFile(t,"Ordenes de trabajo")}}]),e}(),De.\u0275fac=function(e){return new(e||De)(y.Vb(M.a),y.Vb(x.a),y.Vb(a.f),y.Vb(C.a),y.Vb(k.a),y.Vb(w.a),y.Vb(a.d))},De.\u0275cmp=y.Pb({type:De,selectors:[["app-work-order-manager"]],decls:120,vars:24,consts:[["id","container__content"],["id","container__table_workOrder"],[3,"formGroup"],[1,"container__filter"],[1,"container__col"],["type","text","formControlName","txtCode",1,"form-control"],["type","text","formControlName","txtLicense_plate",1,"form-control"],["type","text","placeholder","fecha inicio ...","bsDatepicker","","formControlName","txtInit_date",1,"form-control",3,"bsValue","bsConfig"],["type","text","placeholder","fecha fin ...","bsDatepicker","","formControlName","txtEnd_date",1,"form-control",3,"bsValue","bsConfig"],["formControlName","cmbState",1,"form-control"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","container__col",4,"ngIf"],[1,"container__buttons"],["class","btn btn-info",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"text-right"],[1,"btn","btn-primary",3,"click"],["class","btn-add btn-info",3,"click",4,"ngIf"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],["id","container__workOrder"],[3,"workOrderWasSaved","workOrderWasCanceled"],["id","container__resume_main"],[1,"overlay"],[1,"card","card-review"],[1,"card-header","container__header"],[1,"container__buttonClose"],[1,"fas","fa-times",3,"click"],[1,"card-body"],[3,"trx_id"],["id","container__FinalizeWorkOrder"],[1,"card-footer"],["formControlName","txtObservationApprobation","cols","30","rows","2",1,"form-control"],["id","container__buttons",1,"buttons__container"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["id","container__Cancelation"],["formControlName","txtObservationCancelation","cols","30","rows","2",1,"form-control"],[4,"ngIf"],[3,"countChanges","dealerWasSetted"],[3,"countChanges","clientWasSetted"],[1,"btn","btn-info",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"btn-add","btn-info",3,"click"],[1,"fas","fa-plus"],[3,"id"],["title","M\xe1s informaci\xf3n",1,"fas","fa-info-circle","text-info",3,"click"],[1,"container__controls",3,"ngSwitch"],[4,"ngSwitchCase"],["title","Finalizar",1,"fas","fa-check-circle","text-success",3,"click"],["title","Anular",1,"fas","fa-times-circle","text-danger",3,"click"],["title","Editar",1,"far","fa-edit",3,"click"]],template:function(e,t){1&e&&(y.bc(0,"div",0),y.bc(1,"div",1),y.bc(2,"h1"),y.Mc(3,"\xd3rdenes de trabajo"),y.ac(),y.bc(4,"form",2),y.bc(5,"div",3),y.bc(6,"div",4),y.bc(7,"label"),y.Mc(8,"C\xf3digo"),y.ac(),y.Wb(9,"input",5),y.ac(),y.bc(10,"div",4),y.bc(11,"label"),y.Mc(12,"Placa"),y.ac(),y.Wb(13,"input",6),y.ac(),y.bc(14,"div",4),y.bc(15,"label"),y.Mc(16,"Fecha inicio:"),y.ac(),y.Wb(17,"input",7),y.ac(),y.bc(18,"div",4),y.bc(19,"label"),y.Mc(20,"Fecha fin:"),y.ac(),y.Wb(21,"input",8),y.ac(),y.bc(22,"div",4),y.bc(23,"label"),y.Mc(24,"Estado"),y.ac(),y.bc(25,"select",9),y.bc(26,"option",10),y.Mc(27,"Seleccione ..."),y.ac(),y.Lc(28,_e,3,4,"option",11),y.ac(),y.ac(),y.Lc(29,ye,2,1,"div",12),y.Lc(30,Me,2,1,"div",12),y.bc(31,"div",13),y.Lc(32,xe,2,0,"button",14),y.Lc(33,Ce,2,0,"button",15),y.ac(),y.ac(),y.bc(34,"div",16),y.bc(35,"button",17),y.ic("click",(function(){return t.downloadExcel()})),y.Mc(36," Descargar Excel "),y.ac(),y.ac(),y.ac(),y.Lc(37,ke,2,0,"button",18),y.bc(38,"table",19),y.bc(39,"thead"),y.bc(40,"th"),y.Mc(41,"#"),y.ac(),y.bc(42,"th"),y.Mc(43,"C\xf3digo"),y.ac(),y.bc(44,"th"),y.Mc(45,"Placa"),y.ac(),y.bc(46,"th"),y.Mc(47,"Cliente"),y.ac(),y.bc(48,"th"),y.Mc(49,"Mantenimiento"),y.ac(),y.bc(50,"th"),y.Mc(51,"Sucursal"),y.ac(),y.bc(52,"th"),y.Mc(53,"Fecha"),y.ac(),y.bc(54,"th"),y.Mc(55,"Valor"),y.ac(),y.bc(56,"th"),y.Mc(57,"Estado"),y.ac(),y.bc(58,"th"),y.Mc(59,"Acciones"),y.ac(),y.ac(),y.bc(60,"tbody"),y.Lc(61,We,30,27,"tr",20),y.ac(),y.ac(),y.ac(),y.bc(62,"div",21),y.bc(63,"app-work-order",22),y.ic("workOrderWasSaved",(function(){return t.getListWorkOrders()}))("workOrderWasCanceled",(function(){return t.closeWorkOrder()})),y.ac(),y.ac(),y.ac(),y.bc(64,"div",23),y.bc(65,"div",24),y.bc(66,"div",25),y.bc(67,"div",26),y.bc(68,"h2"),y.Mc(69),y.ac(),y.bc(70,"div",27),y.bc(71,"a"),y.bc(72,"i",28),y.ic("click",(function(){return t.closePopUp("container__resume_main")})),y.ac(),y.ac(),y.ac(),y.ac(),y.bc(73,"div",29),y.Wb(74,"app-transaction-review",30),y.ac(),y.ac(),y.ac(),y.ac(),y.bc(75,"div",31),y.bc(76,"div",24),y.bc(77,"div",25),y.bc(78,"div",26),y.bc(79,"h2"),y.Mc(80),y.ac(),y.bc(81,"div",27),y.bc(82,"a"),y.bc(83,"i",28),y.ic("click",(function(){return t.closePopUp("container__FinalizeWorkOrder")})),y.ac(),y.ac(),y.ac(),y.ac(),y.bc(84,"div",29),y.Wb(85,"app-transaction-review",30),y.ac(),y.bc(86,"div",32),y.bc(87,"form",2),y.bc(88,"div"),y.bc(89,"legend"),y.Mc(90," Observaciones de la finalizaci\xf3n de la orden de trabajo "),y.ac(),y.bc(91,"textarea",33),y.Mc(92,"            "),y.ac(),y.ac(),y.ac(),y.bc(93,"div",34),y.bc(94,"button",35),y.ic("click",(function(){return t.closePopUp("container__FinalizeWorkOrder"),t.clearForms()})),y.Mc(95," Cancelar "),y.ac(),y.bc(96,"button",36),y.ic("click",(function(){return t.finalizeWorkOrder()})),y.Mc(97," Guardar "),y.ac(),y.ac(),y.ac(),y.ac(),y.ac(),y.ac(),y.bc(98,"div",37),y.bc(99,"div",24),y.bc(100,"div",25),y.bc(101,"div",26),y.bc(102,"h2"),y.Mc(103),y.ac(),y.bc(104,"div",27),y.bc(105,"a"),y.bc(106,"i",28),y.ic("click",(function(){return t.closePopUp("container__Cancelation")})),y.ac(),y.ac(),y.ac(),y.ac(),y.bc(107,"div",29),y.Wb(108,"app-transaction-review",30),y.ac(),y.bc(109,"div",32),y.bc(110,"form",2),y.bc(111,"legend"),y.Mc(112,"Observaciones de la anulaci\xf3n"),y.ac(),y.Wb(113,"textarea",38),y.bc(114,"div",34),y.bc(115,"button",35),y.ic("click",(function(){return t.closePopUp("container__Cancelation"),t.clearForms()})),y.Mc(116," Cancelar "),y.ac(),y.bc(117,"button",36),y.ic("click",(function(){return t.cancelWorkOrder()})),y.Mc(118," Guardar "),y.ac(),y.ac(),y.ac(),y.ac(),y.ac(),y.ac(),y.ac(),y.Lc(119,Te,1,0,"app-img-loading",39)),2&e&&(y.Jb(4),y.uc("formGroup",t.frm_filter),y.Jb(13),y.uc("bsValue",t.init_date)("bsConfig",y.wc(22,Be)),y.Jb(4),y.uc("bsValue",t.end_date)("bsConfig",y.wc(23,Be)),y.Jb(5),y.uc("value",-1),y.Jb(2),y.uc("ngForOf",t.lsTransactionStates),y.Jb(1),y.uc("ngIf",!t.isDealer||t.isMainCompany),y.Jb(1),y.uc("ngIf",t.isDealer),y.Jb(2),y.uc("ngIf",!t.isFiltered),y.Jb(1),y.uc("ngIf",t.isFiltered),y.Jb(4),y.uc("ngIf",t.isDealer),y.Jb(24),y.uc("ngForOf",t.lsWorkOrderByDealer),y.Jb(8),y.Oc(" Resumen orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),y.Jb(5),y.uc("trx_id",t.trx_id),y.Jb(6),y.Oc(" Finalizar orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),y.Jb(5),y.uc("trx_id",t.trx_id),y.Jb(2),y.uc("formGroup",t.frmApprovedTrx),y.Jb(16),y.Oc(" Anular orden de trabajo: ",null!=t.transactionSelected&&null!=t.transactionSelected?t.transactionSelected.code:""," "),y.Jb(5),y.uc("trx_id",t.trx_id),y.Jb(2),y.uc("formGroup",t.frmCancelTrx),y.Jb(9),y.uc("ngIf",t.isAwaiting))},directives:[o.B,o.r,o.k,o.c,o.q,o.i,S.b,S.a,o.x,o.u,o.A,a.n,a.o,be,me.a,ge.a,ve.a,a.q,a.r,oe.a],pipes:[a.x,a.y,a.f,a.d],styles:["#container__workOrder[_ngcontent-%COMP%]{display:none}.tag-error[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:#ea2c62;padding:8px 20px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}.tag-active[_ngcontent-%COMP%]{background-color:#ade498}.tag-active[_ngcontent-%COMP%], .tag-ending[_ngcontent-%COMP%]{display:flex;flex-direction:row;padding:8px 40px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}.tag-ending[_ngcontent-%COMP%]{background-color:#469627}.tag-canceled[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:#7e0c2c;padding:8px 40px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}.container__controls[_ngcontent-%COMP%]{display:inline-block}.tag-pending[_ngcontent-%COMP%]{display:flex;flex-direction:row;background-color:#f0e050;padding:8px 40px;color:#fff;border-radius:20px;width:150px;align-items:center;justify-content:center}#container__content[_ngcontent-%COMP%]{transition:margin-left 1s;padding:20px;margin-left:250px}i[_ngcontent-%COMP%]{margin:0 3px;cursor:pointer}.col-number[_ngcontent-%COMP%]{max-width:50px;width:50px}.btn-add[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{cursor:pointer}.btn-add[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;position:relative;left:93%;margin-bottom:20px;top:10px;outline:none;text-align:center;font-size:24px;border:none;z-index:55}.overlay[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3fr);grid-template-rows:repeat(3fr);position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(6,129,230,.1);border-radius:15px;align-items:center;justify-items:center;z-index:5000;width:100%;height:100%;overflow:scroll;overflow-x:hidden}#container__resume_main[_ngcontent-%COMP%]{display:none}.container__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.container__buttonClose[_ngcontent-%COMP%]{margin-top:10px}.card-review[_ngcontent-%COMP%]{width:1200px;height:auto}.container__filter[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;margin-bottom:10px}.container__filter[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:10px 20px;width:250px}.container__buttons[_ngcontent-%COMP%]{justify-content:center;align-items:center}.container__buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:125px;height:auto;margin-left:10px;margin-top:30px}#container__Cancelation[_ngcontent-%COMP%], #container__FinalizeWorkOrder[_ngcontent-%COMP%]{display:none}.buttons__container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}button[_ngcontent-%COMP%]{width:250px;margin-left:10px;margin-top:20px}"]}),De)}]}],Ve=((Fe=function e(){c(this,e)}).\u0275mod=y.Tb({type:Fe}),Fe.\u0275inj=y.Sb({factory:function(e){return new(e||Fe)},imports:[[l.f.forChild(Le)],l.f]}),Fe),Ee=((Ae=function e(){c(this,e)}).\u0275mod=y.Tb({type:Ae}),Ae.\u0275inj=y.Sb({factory:function(e){return new(e||Ae)},imports:[[a.c,o.l,o.w,s.a,Ve,S.c.forRoot()]]}),Ae)},"U+sL":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("tk/3"),a=n("fXoL"),o=function(){var e=function(){function e(t){c(this,e),this.http=t,this.URL_API="/API_FleetService/api/Branch/",this.HttpOptions={headers:new r.c({"Content-Type":"application/json"})}}return i(e,[{key:"getBranchs",value:function(e,t){return this.http.get("".concat(this.URL_API,"/Get?pOwner_id=").concat(e,"&pKindOfOwner=").concat(t))}},{key:"insert",value:function(e){return this.http.post(this.URL_API+"/Insert",e,this.HttpOptions)}},{key:"update",value:function(e){return this.http.post(this.URL_API+"/Update",e,this.HttpOptions)}},{key:"delete",value:function(e){return this.http.post(this.URL_API+"/Delete",e,this.HttpOptions)}},{key:"setBranchSelected",value:function(e){this.branchSelected=e}},{key:"getBranchSelected",value:function(){return this.branchSelected}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.fc(r.a))},e.\u0275prov=a.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},i5Qh:function(e,n,r){"use strict";r.d(n,"a",(function(){return d}));var a=r("tk/3"),o=r("LRne"),s=r("JIr8"),l=r("AytR"),u=r("fXoL"),d=function(){var e=function(){function e(t){c(this,e),this.http=t,this.URL_API=l.a.apiUrl+"/Client",this.HttpOptions={headers:new a.c({"Content-Type":"application/json"})}}var n,r,u;return i(e,[{key:"getClients",value:function(){return this.http.get(this.URL_API+"/Get")}},{key:"getClientById",value:(u=t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.get("".concat(this.URL_API,"/GetById?pId=").concat(t)).toPromise());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getClientByDocument",value:(r=t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.get("".concat(this.URL_API,"/GetByDocument?pDocument=").concat(t)).toPromise());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getClientsByDescriptions",value:function(e){return e.trim()?this.http.get("".concat(this.URL_API,"/GetByDescription?sDescription=").concat(e)).pipe(Object(s.a)(this.handleError("getClientsByDescriptions",[]))):Object(o.a)([])}},{key:"insertClient",value:function(e){return this.http.post(this.URL_API+"/Insert",e,this.HttpOptions)}},{key:"updateClient",value:function(e){return this.http.post(this.URL_API+"/Update",e,this.HttpOptions)}},{key:"deleteClient",value:(n=t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.http.post(this.URL_API+"/Delete",t,this.HttpOptions).toPromise());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setClientToUpdate",value:function(e){this.clientToUpdate=e}},{key:"getClientToUpdate",value:function(){return this.clientToUpdate}},{key:"setClientSelected",value:function(e){this.clientSelected=e}},{key:"getClientSelected",value:function(){return this.clientSelected}},{key:"getBlockFormClient",value:function(){return this.blockFormClient}},{key:"setBlockFormClient",value:function(e){this.blockFormClient=e}},{key:"getAction",value:function(){return this.action}},{key:"setAction",value:function(e){this.action=e}},{key:"handleError",value:function(){var e=arguments.length>1?arguments[1]:void 0;return function(t){return console.error(t),Object(o.a)(e)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.fc(a.a))},e.\u0275prov=u.Rb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}])}();